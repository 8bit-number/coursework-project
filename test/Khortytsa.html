<!DOCTYPE doctype html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://opengraphprotocol.org/schema/">
 <head>
  <link href="https://static.thecrag.com" rel="preconnect"/>
  <link href="https://image.thecrag.com" rel="preconnect"/>
  <meta content="upgrade-insecure-requests" http-equiv="Content-Security-Policy"/>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <link href="https://www.thecrag.com/climbing/ukraine/area/1140720441" rel="canonical">
   <title>
    Khortytsa, Sport climbing | theCrag
   </title>
   <meta content="141410435911098" property="fb:app_id"/>
   <meta content="https://www.thecrag.com/climbing/ukraine/area/1140720441" property="og:url"/>
   <meta content="theCrag" property="og:site_name"/>
   <meta content="Khortytsa, Sport climbing | theCrag" property="og:title"/>
   <meta content="35.09548527301" property="place:location:longitude"/>
   <meta content="47.82218751058" property="place:location:latitude"/>
   <meta content="activity" property="og:type"/>
   <meta content="Khortytsa is a area inside of Ukraine" name="description" property="og:description"/>
   <link href="https://static.thecrag.com/cids/images/favicon-1.1.1.ico" rel="shortcut icon" type="image/x-icon">
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=3" name="viewport"/>
    <link href="https://static.thecrag.com/cids/images/logo-114-1.1.1.png" rel="apple-touch-icon-precomposed" sizes="114x114"/>
    <link href="/open-search.xml?v=2" rel="search" title="Search theCrag" type="application/opensearchdescription+xml"/>
    <link href="https://static.thecrag.com/cids/portal-1.1.60.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
    </script>
    <!--[if lt IE 8]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/json2/20160511/json2.min.js"></script>
<![endif]-->
    <script>
     var staticBase = 'https://static.thecrag.com/';
    </script>
   </link>
  </link>
 </head>
 <body class="responsive" data-kudos="0" data-nid="1140720441" id="default">
  <script type="text/javascript">
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-18400027-1', {
 'siteSpeedSampleRate': 100,
 'userId': ''
});
ga('require', 'linkid', 'linkid.js');
var l = window.location;
var gapath = l.pathname.replace(/([^\/])$/, '$1/');
var gaurl = gapath+l.search;
ga('require', 'outboundLinkTracker');
ga('set', 'dimension1', '');
ga('set', '&uid', '');
ga('set', 'dimension2', 'area/mainpage');
ga('set', 'dimension3', location.protocol.replace(':', ''));
ga('set', 'dimension4', '0');
ga('set', 'dimension5', '0');
ga('send', 'pageview', gaurl);

window.onerror=function(e,f,l){
 ga('send', 'exception', {
  'exDescription': e+':'+l,
  'exFatal': false,
  'appName': f
 });
}
var s='unknown';if(parent!==self){
 try{s=parent.location.href}catch(e){}
 ga('send', 'exception', {
  'exDescription': 'Inside frame:'+parent.location.href,
  'exFatal': false
 });
}
  </script>
  <script src="https://static.thecrag.com/autotrack-2.4.1/autotrack.js">
  </script>
  <input class="hide" id="state-nav" type="checkbox"/>
  <div id="fb-root">
  </div>
  <script>
   function responseLogin(response) {
  responseFB(response,'btnLogin');
}
function responseSignup(response) {
  responseFB(response,'btnSignup');
}
function responseFB(response,btnLabel) {
 if (response.authResponse) {
  var auth = response.authResponse;
  $('<input id="token" name="D:Token" type="hidden" value="' + auth.accessToken + '" />' +
    '<input id="extUser" name="D:ExternalUser" type="hidden" value="' + auth.userID + '" />' +
    '<input type="hidden" name="D:LoginOrRegister" value="1" />' + 
    '<input id="extIFace" name="D:ExternalIFace" type="hidden" value="facebook_www" />').insertBefore('#'+btnLabel);
  $('#'+btnLabel).closest('form').find('.control-group input[type!=hidden]').removeAttr('required')
  $("#"+btnLabel).trigger('click');
 }
}
function fbLoginSuccess() { 
 FB.getLoginStatus(responseLogin);
}
function fbSignupSuccess() { 
 FB.getLoginStatus(responseSignup);
}
window.fbAsyncInit = function() {
 FB.init({
  appId      : '141410435911098',
  channelURL : 'http://www.thecrag.com/channel.html',
  status     : true,
  cookie     : true,
  oauth      : true,
  xfbml      : true
 });
};
function FBboot(){
(function(d, s, id) {
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) return;
 js = d.createElement(s); js.id = id;
 js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=141410435911098";
 fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
}
  </script>
  <div id="result">
  </div>
  <script>
   function gLoginSuccess(auth) { 
 if (auth.code) {
  var btnLabel = 'btnLogin';
  $('<input id="token" name="D:Code" type="hidden" value="' + auth.code + '" />' +
    '<input type="hidden" name="D:LoginOrRegister" value="1" />' + 
    '<input type="hidden" name="D:GoogleOAuth2" value="1" />' + 
    '<input id="extIFace" name="D:ExternalIFace" type="hidden" value="google_www" />').insertBefore('#'+btnLabel);
  $('#'+btnLabel).closest('form').find('.control-group input[type!=hidden]').removeAttr('required')
  $("#"+btnLabel).trigger('click');
 }
}
function googleBoot(){
 var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
 po.src = 'https://apis.google.com/js/client:platform.js?onload=googleLoginInit';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
}
function googleLoginInit() {
  gapi.load('auth2', function() {
    google_signin_auth2 = gapi.auth2.init({
      client_id: '693569563172-dc5fhd6kr86fg8mcaf76go1ioffqpc1p.apps.googleusercontent.com',
      scope: 'profile email',
    });
  });
  gapi.signin2.render('signinButton', {
    width: 120,
    height: 30,
    theme: 'dark',
  });

}
  </script>
  <div class="" id="wrapper">
   <div class="bust">
    <div class="bust__black">
     <div class="bust__crumb">
      <div class="regions__crumbtrail">
       <div class="regions__inner">
        <div class="crumbs" id="breadCrumbs">
         <div class="crumbs__all">
          <div class="crumb crumb--first crumb--children crumb--menu dropdown-menu--trigger">
           <a class="crumb__a" data-nid="7546063" href="/climbing/world" itemprop="url">
            <span class="crumb__icon">
             <i class="icon-globe">
             </i>
            </span>
           </a>
          </div>
          <div class="crumb crumb--children" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
           <span class="crumb__sep crumb--menu crumb--spin dropdown-menu--trigger">
            <i class="icon-angle-right">
            </i>
           </span>
           <a class="crumb__a" data-nid="11737771" href="/climbing/europe" itemprop="url">
            <span class="crumb__long" itemprop="title">
             Europe
            </span>
           </a>
          </div>
          <div class="crumb crumb--children" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
           <span class="crumb__sep crumb--menu crumb--spin dropdown-menu--trigger">
            <i class="icon-angle-right">
            </i>
           </span>
           <a class="crumb__a" data-nid="11748067" href="/climbing/ukraine" itemprop="url">
            <span class="crumb__long" itemprop="title">
             Ukraine
            </span>
           </a>
          </div>
          <div class="crumb crumb--selected crumb--children" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
           <span class="crumb__sep crumb--menu crumb--spin dropdown-menu--trigger">
            <i class="icon-angle-right">
            </i>
           </span>
           <a class="crumb__a" data-nid="1140720441" href="/climbing/ukraine/area/1140720441" itemprop="url">
            <span class="crumb__long" itemprop="title">
             Khortytsa
            </span>
           </a>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="bust__search">
      <form action="/climbing/ukraine/area/1140720441/search" class="search-form" id="search" method="get">
       <input autocomplete="off" name="S" placeholder="search" type="search" value=""/>
       <button class="go btn btn-small" type="submit">
        <i class="icon-search">
        </i>
       </button>
      </form>
      <a class="" href="/climbing/ukraine/area/1140720441/search" id="failsearch" title="Search">
       <i class="icon-search">
       </i>
      </a>
     </div>
    </div>
    <div class="bust__white">
     <div class="bust__burger">
      <label class="burger" for="state-nav">
       <div class="burger__box">
        <div class="burger__t">
        </div>
        <div class="burger__m">
        </div>
        <div class="burger__b">
        </div>
       </div>
      </label>
     </div>
     <div class="bust__logo">
      <a class="iblock ablock" href="/home">
       <img alt="rock climbing" src="https://static.thecrag.com/cids/images/logo17-1.1.1.svg"/>
      </a>
     </div>
     <div class="bust__tabs">
      <div class="tabs tabs--center tabs--primary" id="js751481">
       <div class="tabs__slider">
        <div class="tabs__start">
        </div>
        <div class="tab iblock tab--selected tab--icon" id="pt_sitemap">
         <a class="iblock" data-nid="1140720441" href="/climbing/ukraine/area/1140720441">
          <i class="icon-sitemap icon-em">
          </i>
          Index
         </a>
         <div class="tab__menu">
         </div>
        </div>
        <div class="tab iblock tab--icon" id="pt_maps">
         <a class="iblock" data-nid="1140720441" href="/climbing/ukraine/area/1140720441/maps">
          <i class="icon-map-marker icon-em">
          </i>
          Map
         </a>
         <div class="tab__menu">
          <ul class="dropdown-menu bubble-top-left">
           <li>
            <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441/maps">
             Khortytsa map
            </a>
           </li>
           <li>
            <a href="/climbing/world/maps">
             World map
            </a>
           </li>
          </ul>
         </div>
        </div>
        <div class="tab iblock tab--icon" id="pt_climbers">
         <a class="iblock" data-nid="1140720441" href="/climbing/ukraine/area/1140720441/contributors" rel="nofollow">
          <i class="icon-male icon-em">
          </i>
          Climbers
         </a>
         <div class="tab__menu">
          <ul class="dropdown-menu bubble-top-left">
           <li class="nav-header">
            Khortytsa
           </li>
           <li>
            <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441/contributors" rel="nofollow">
             Contributors
            </a>
           </li>
           <li>
            <a href="/climbing/ukraine/area/1140720441/climbers/using-stat/trad-rating/">
             Trad rating
            </a>
           </li>
           <li>
            <a href="/climbing/ukraine/area/1140720441/climbers/using-stat/sport-rating/">
             Sport rating
            </a>
           </li>
           <li>
            <a href="/climbing/ukraine/area/1140720441/climbers/using-stat/boulder-rating/">
             Boulder rating
            </a>
           </li>
           <li class="nav-header">
            World
           </li>
           <li>
            <a href="/climbing/world/contributors">
             World contributors
            </a>
           </li>
           <li>
            <a href="/climbing/world/climbers/using-stat/trad-rating/">
             Trad rating
            </a>
           </li>
           <li>
            <a href="/climbing/world/climbers/using-stat/sport-rating/">
             Sport rating
            </a>
           </li>
           <li>
            <a href="/climbing/world/climbers/using-stat/boulder-rating/">
             Boulder rating
            </a>
           </li>
          </ul>
         </div>
        </div>
        <div class="tab iblock tab--icon" id="pt_forum">
         <a class="iblock" data-nid="1140720441" href="/climbing/ukraine/area/1140720441/forum" rel="nofollow">
          <i class="icon-comments icon-em">
          </i>
          Forum
         </a>
         <div class="tab__menu">
          <ul class="dropdown-menu bubble-top-left">
           <li class="nav-header">
            Khortytsa
           </li>
           <li>
            <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441/forum" rel="nofollow">
             Forum
            </a>
           </li>
          </ul>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
<li class="nav-header">
 General
</li>
<li>
 <a href="/climbing/world/forum">
  World Forum
 </a>
</li>
<li>
 <a href="/forum/release">
  Release forum
 </a>
</li>
<div class="tab iblock tab--icon" id="pt_photos">
 <a class="iblock" data-nid="1140720441" href="/climbing/ukraine/area/1140720441/photos">
  <i class="icon-camera icon-em">
  </i>
  Photos
 </a>
 <div class="tab__menu">
  <ul class="dropdown-menu bubble-top-left">
   <li class="nav-header">
    Khortytsa
   </li>
   <li>
    <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441/photos">
     Photos
    </a>
   </li>
  </ul>
 </div>
</div>
<li>
 <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441/topos">
  Topos
 </a>
</li>
<li>
 <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441/webcovers">
  Web-Covers
 </a>
</li>
<li class="nav-header">
 World
</li>
<li>
 <a href="/climbing/world/photos">
  Photos
 </a>
</li>
<li>
 <a href="/climbing/world/topos">
  Topos
 </a>
</li>
<li>
 <a href="/climbing/world/webcovers">
  Web-Covers
 </a>
</li>
<div class="tab iblock tab--icon" id="pt_logbook">
 <a class="iblock" data-nid="1140720441" href="/climbing/ukraine/area/1140720441/ascents">
  <i class="icon-check icon-em">
  </i>
  Logbook
 </a>
 <div class="tab__menu">
  <ul class="dropdown-menu bubble-top-left">
   <li class="nav-header">
    Khortytsa
   </li>
   <li>
    <a href="/climbing/ukraine/area/1140720441/ascents" rel="nofollow">
     Ascents
    </a>
    <li class="nav-header">
     World
    </li>
    <li>
     <a href="/climbing/world/ascents">
      Ascents
     </a>
    </li>
   </li>
  </ul>
 </div>
</div>
<div class="tab iblock tab--icon" id="pt_help">
 <a class="iblock" href="/en/article/contactus">
  <i class="icon-info-sign icon-em">
  </i>
  Help
 </a>
 <div class="tab__menu">
  <ul class="dropdown-menu bubble-top-left">
   <li>
    <a href="/home">
     Homepage
    </a>
   </li>
   <li class="divider">
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/help">
     Help
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/contactus">
       Contact Us
      </a>
     </li>
     <li>
      <a href="/en/article/media">
       Media resources
      </a>
     </li>
     <li>
      <a href="/en/article/beginners">
       Introduction to Rock Climbing
      </a>
     </li>
     <li>
      <a href="/en/article/vision">
       Mission and Vision
      </a>
     </li>
     <li>
      <a href="/en/article/supporter">
       Become a financial supporter
      </a>
     </li>
     <li>
      <a href="/en/article/issues">
       Bugs and new features
      </a>
     </li>
     <li>
      <a href="/en/article/policies">
       Policies
      </a>
     </li>
     <li>
      <a href="/en/article/credit">
       Credit and thanks
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/explore">
     Getting started
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/search">
       Searching
      </a>
     </li>
     <li>
      <a href="/en/article/grades">
       Grades
      </a>
     </li>
     <li>
      <a href="/en/article/styles">
       Route styles
      </a>
     </li>
     <li>
      <a href="/en/article/stars">
       How stars work
      </a>
     </li>
     <li>
      <a href="/en/article/cragguru">
       Nearby iconic routes
      </a>
     </li>
     <li>
      <a href="/en/article/classiccrags">
       Classic crags
      </a>
     </li>
     <li>
      <a href="/en/article/seasonality">
       Seasonality
      </a>
     </li>
     <li>
      <a href="/en/article/behavior">
       Acceptable site behavior
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/guidebooks">
     Get guidebooks
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/pdfcragguide">
       PDF Crag Guide
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/ticking">
     Ticking and logbook
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/loggingascents">
       Logging ascents
      </a>
     </li>
     <li>
      <a href="/en/article/export8a">
       Export ascent data from 8a.nu
      </a>
     </li>
     <li>
      <a href="/en/article/ticktypes">
       Tick types
      </a>
     </li>
     <li>
      <a href="/en/article/cpr">
       Climber Performance Rating (CPR)
      </a>
     </li>
     <li>
      <a href="/en/article/cprtimeline">
       CPR timeline explained
      </a>
     </li>
     <li>
      <a href="/en/article/tickshift">
       Calculating tick shift
      </a>
     </li>
     <li>
      <a href="/en/article/hardestroutes">
       Hardest routes
      </a>
     </li>
     <li>
      <a href="/en/article/rankings">
       Check your local and global ranking
      </a>
     </li>
     <li>
      <a href="/en/article/importlogbook">
       Import your logbook
      </a>
     </li>
     <li>
      <a href="/en/article/exportlogbook">
       Export your logbook
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/connect">
     Contribute and connect
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/favoritecrags">
       Favorite crags
      </a>
     </li>
     <li>
      <a href="/en/article/profile">
       Publish your profile
      </a>
     </li>
     <li>
      <a href="/en/article/watching">
       Watching discussions
      </a>
     </li>
     <li>
      <a href="/en/article/facebookpublishing">
       Facebook connect
      </a>
     </li>
     <li>
      <a href="/en/article/circuits">
       Lists and circuits
      </a>
     </li>
     <li>
      <a href="/en/article/connect-offline">
       Connect with climbers offline
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/contributing">
     Adding content
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/indexpermissions">
       User permissions
      </a>
     </li>
     <li>
      <a href="/en/article/cragkarma">
       Karma
      </a>
     </li>
     <li>
      <a href="/en/article/updatingdescriptions">
       Write descriptions
      </a>
     </li>
     <li>
      <a href="/en/article/topotutorial">
       Drawing topos
      </a>
     </li>
     <li>
      <a href="/en/article/topophotos">
       Taking photos for topos
      </a>
     </li>
     <li>
      <a href="/en/article/hashtagging">
       Hash tagging
      </a>
     </li>
     <li>
      <a href="/en/article/documentingacrag">
       Creating a new crag
      </a>
     </li>
     <li>
      <a href="/en/article/areatypes">
       Area types
      </a>
     </li>
     <li>
      <a href="/en/article/structure">
       Structuring a crag
      </a>
     </li>
     <li>
      <a href="/en/article/namingpolicy">
       Naming conventions
      </a>
     </li>
     <li>
      <a href="/en/article/geolocation">
       Maps and geolocations
      </a>
     </li>
     <li>
      <a href="/en/article/tagging">
       Structured tagging
      </a>
     </li>
     <li>
      <a href="/en/article/sensitivecrags">
       Private, sensitive and closed crags
      </a>
     </li>
     <li>
      <a href="/en/article/webcovers">
       Creating Web-Covers
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/advanced">
     Advanced editing
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/embedingimages">
       Embedding photos and videos
      </a>
     </li>
     <li>
      <a href="/en/article/merging">
       Merging routes and areas
      </a>
     </li>
     <li>
      <a href="/en/article/mixedcopyright">
       Mixed copyright
      </a>
     </li>
     <li>
      <a href="/en/article/publisherparticipation">
       Publisher participation
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/gymsolution">
     Gym Solution by theCrag
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/gymlist">
       Add your Gym to theCrag
      </a>
     </li>
     <li>
      <a href="/en/article/gymapplication">
       Register your Gym
      </a>
     </li>
     <li>
      <a href="/en/article/gymticking">
       Indoor Gym Ascents
      </a>
     </li>
     <li>
      <a href="/en/article/competitions">
       Climbing Contests &amp; Competitions on theCrag
      </a>
     </li>
     <li>
      <a href="/en/article/gympermissions">
       Managing Gym Permissions
      </a>
     </li>
     <li>
      <a href="/en/article/gymarchiveroute">
       Archiving a Gym Route
      </a>
     </li>
     <li>
      <a href="/en/article/klimbz">
       Klimbz Premium Gym Solution
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/partner">
     Partner with us
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/advocacygroups">
       Advocacy Groups
      </a>
     </li>
     <li>
      <a href="/en/article/developers">
       Crag Developers &amp; Guidebook Editors
      </a>
     </li>
     <li>
      <a href="/en/article/localbusiness">
       Local business
      </a>
     </li>
     <li>
      <a href="/en/article/business">
       Business sponsorship
      </a>
     </li>
     <li>
      <a href="/en/article/adspecifications">
       Ad specifications
      </a>
     </li>
    </ul>
   </li>
   <li class="dropdown-submenu">
    <a href="/en/article/extend">
     Embed and API
    </a>
    <ul class="dropdown-menu">
     <li>
      <a href="/en/article/api">
       Sharing and embeding (API)
      </a>
     </li>
     <li>
      <a href="/en/article/oembed">
       Embed theCrag
      </a>
     </li>
     <li>
      <a href="/en/article/app-countyguide">
       App Case Study: Country guide to climbing areas
      </a>
     </li>
     <li>
      <a href="/en/article/app-rebrandedsite">
       App Case Study: Full climbing guide on rebranded site
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </div>
</div>
<div class="tabs__end">
</div>
<script>
 (function selectTabjs751481(){
    var $t = $('#js751481');
    var $s = $t.find('.tab--selected');
    $s.length && $t.find('.tabs__slider').scrollLeft($s[0].offsetLeft - $t.width()/2 + $s.width()/2);
})();
</script>
<div class="bust__login">
 <div class="login-button">
  <a class="btn btn-primary login" href="/dashboard" id="loginbutton">
   <span>
    Log in
   </span>
  </a>
  <div class="popover bottom bubble-top-right" id="loginpopover" style="right: 0; top: 40px;">
   <div class="popover-content">
    <div class="waiting-c fb" style="height: 38px;text-align:center">
     <div class="fb-login-button" onlogin="fbLoginSuccess();" scope="email,publish_actions" size="xlarge">
     </div>
    </div>
    <div class="divider">
    </div>
    <div class="waiting-c" style="height: 31px;text-align:center">
     <style type="text/css">
      #signinButton{
  width: 100%;
}
#signinButton > div{
  margin: 0 auto;
}
     </style>
     <div id="signinButton">
      Sign in with Google
     </div>
     <script>
      $('#signinButton').click(function() {
    google_signin_auth2.grantOfflineAccess().then(gLoginSuccess);
  });
     </script>
    </div>
    <div class="divider">
    </div>
    <form action="https://www.thecrag.com//CIDS/cgi-bin/cids.cgi" class="bs-docs-example form-horizontal" method="post">
     <div class="control-group">
      <label class="control-label" for="username">
       Username
      </label>
      <input autocapitalize="off" autocorrect="off" id="username" name="D:Login" placeholder="Username" type="text"/>
     </div>
     <div class="control-group">
      <label class="control-label" for="inputPassword">
       Password
      </label>
      <input id="inputPassword" name="D:Password" placeholder="Password" type="password"/>
     </div>
     <div class="control-group">
      <div class="">
       <button class="btn btn-primary btn-block" id="btnLogin" name="State:Login" type="submit">
        Login
       </button>
       <a class="forgot" href="/processmap/requestpassword">
        Forgot your login details?
       </a>
      </div>
     </div>
     <input name="C:ResetContinueURL" type="hidden" value="1">
      <input name="C:Portal" type="hidden" value="Default Licensee">
       <input name="D:LoginTarget" type="hidden" value="https://www.thecrag.com/climbing/ukraine/area/1140720441"/>
       <input name="D:CSRF" type="hidden" value="PAVQiUYuqWsc8BhQps5tbg"/>
      </input>
     </input>
    </form>
    <div class="divider">
    </div>
    <a class="btn btn-block" href="/processmap/signup?lang=en&amp;return=https://www.thecrag.com/climbing/ukraine/area/1140720441">
     Create an account
    </a>
   </div>
  </div>
 </div>
 <style>
  .waiting-c::before {
	display: block;
	height: 20px;
	width: 53px;
	margin: 5px 0 -25px 69px;
	line-height: 20px;
	top: 13px;
	color: white;
}
.waiting-c::before {
	background: #DD4B39;
	content: 'Google';
}
.waiting-c.fb::before {
	background: #5F78AB;
	content: 'Facebook';
}
 </style>
 <script>
  function loginButtonBoot() {
    if (!window.FB && typeof FBboot == 'function') FBboot();
    if (!window.gapi && typeof googleBoot == 'function') googleBoot();
}
$('.login').click(function(e){
    loginButtonBoot();
    $('#loginpopover').toggle();
    $('.login').toggleClass('btn-primary');
    e.preventDefault();
});
$('body').click(function(e){
    if ($(e.target).closest('.login-button').length) return;
    $('#loginpopover').hide();
    $('.login').addClass('btn-primary');
});
 </script>
</div>
<div class="regions__content">
 <div class="regions__headline">
  <div class="regions__inner">
   <div class="headline headline--noavatar headline--nowebcover">
    <div class="headline__act">
     <span>
      <div class="btn-group inline">
       <a class="btn btn-small" id="favorite">
        <i class="icon-heart-empty">
        </i>
        Favorite
       </a>
       <a class="btn btn-small btn-flat" href="/climbing/ukraine/area/1140720441/favorites">
        0
       </a>
      </div>
      <div class="btn-group inline">
       <a class="btn btn-small" href="/climbing/ukraine/area/1140720441/forum#startadiscussion">
        <i class="icon-comment-alt">
        </i>
        Forum
       </a>
      </div>
      <div class="btn-group inline">
       <a class="btn btn-small disabled" href="#" title="Login to request permissions.">
        Request editor permission
       </a>
      </div>
     </span>
    </div>
    <h1 class="heading hash-target h1 mart0 pad8">
     <span class="offset">
      <a id="h1">
      </a>
     </span>
     <span class="heading__t">
      Khortytsa
     </span>
     <span class="heading__byline iblock">
      All Sport climbing
      <span class="info iblock">
       <a href="/climbing/ukraine/area/1140720441/routes">
        <i class="icon-filter">
        </i>
        9
            routes
       </a>
       in
       <a href="/en/article/areatypes">
        area
       </a>
      </span>
     </span>
    </h1>
    <div class="headline__guts">
     <ul class="stats pad4">
      <li>
       <strong>
        Grades:
       </strong>
       <a href="/en/article/grades#context-FR" title="FR - French rating systems including free, bouldering, aid and alpine systems.">
        FR
       </a>
       <li>
        <strong>
         Photos:
        </strong>
        <a href="/climbing/ukraine/area/1140720441/photos">
         3
        </a>
        <li title="Alternate name">
         <strong>
          Aka:
         </strong>
         Хортиця
        </li>
       </li>
      </li>
     </ul>
     <div class="clearfix">
     </div>
     <div class="band style-band band--words">
      <a class="sport" href="/climbing/ukraine/route/1140720441/routes/with-gear-style/sport" style="width: 100%" title="Filter to 9 sport routes">
       SPORT 100%
      </a>
     </div>
    </div>
    <div class="clearfix">
    </div>
   </div>
  </div>
 </div>
 <div class="regions__navdrawer">
  <div class="regions__nav">
   <div class="regions__inner">
    <div class="secondary-navigation">
     <div class="inner needsclick">
      <ul class="embed-menu">
       <li class="group">
        <a data-nid="11748067" href="/climbing/ukraine">
         <i class="icon-double-angle-up">
         </i>
         Ukraine
        </a>
        <li class="dropdown-submenu">
         <a data-nid="11885065" href="/climbing/ukraine/crimea">
          Crimea
         </a>
         <li class="dropdown-submenu">
          <a data-nid="442066716" href="/climbing/ukraine/area/442066716">
           Dovbush Rocks
          </a>
          <li class="dropdown-submenu">
           <a data-nid="442071192" href="/climbing/ukraine/area/442071192">
            Kamyanets'-Podilskyy
           </a>
           <li class="dropdown-submenu">
            <a data-nid="442034250" href="/climbing/ukraine/area/442034250">
             Buky
            </a>
            <li class="dropdown-submenu">
             <a data-nid="12544369" href="/climbing/ukraine/area/12544369">
              Deneshi
             </a>
             <li class="dropdown-submenu">
              <a data-nid="11885089" href="/climbing/ukraine/zhitomir">
               Zhytomyr
              </a>
              <li class="">
               <a data-nid="442881870" href="/climbing/ukraine/area/442881870">
                Dzvonyha
               </a>
               <li class="">
                <a data-nid="1140700836" href="/climbing/ukraine/area/1140700836">
                 Devil's rocks
                </a>
                <li class="">
                 <a data-nid="442870011" href="/climbing/ukraine/area/442870011">
                  Kaspich Roсks (Dynamo)
                 </a>
                 <li class="">
                  <a data-nid="1466447445" href="/climbing/ukraine/area/1466447445">
                   Rayhove lake
                  </a>
                  <li class="dropdown-submenu">
                   <a data-nid="865016424" href="/climbing/ukraine/area/865016424">
                    Korostyshiv
                   </a>
                   <li class="">
                    <a data-nid="1436831586" href="/climbing/ukraine/area/1436831586">
                     Lyagushka/The Frog
                    </a>
                    <li class="">
                     <a data-nid="1206791325" href="/climbing/ukraine/area/1206791325">
                      Korabelnaya balka
                     </a>
                     <li class="">
                      <a data-nid="1206798360" href="/climbing/ukraine/area/1206798360">
                       Aktovskyi kanyon
                      </a>
                      <li class="">
                       <a data-nid="1206792969" href="/climbing/ukraine/area/1206792969">
                        Devil's valley
                       </a>
                       <li class="dropdown-submenu">
                        <a data-nid="442982136" href="/climbing/ukraine/area/442982136">
                         Yuzhnoukrainsk
                        </a>
                        <li class="">
                         <a data-nid="1140809436" href="/climbing/ukraine/area/1140809436">
                          Yuznoukrainsk boulder
                         </a>
                         <li class="dropdown-submenu">
                          <a data-nid="1140777558" href="/climbing/ukraine/area/1140777558">
                           Kamjanka (Ostriv Paskhy)
                          </a>
                          <li class="dropdown-submenu">
                           <a data-nid="1140809340" href="/climbing/ukraine/area/1140809340">
                            Kremenets
                           </a>
                           <li class="dropdown-submenu">
                            <a data-nid="1140777444" href="/climbing/ukraine/area/1140777444">
                             Jamelnica
                            </a>
                            <li class="selected open-submenu">
                             <a data-nid="1140720441" href="/climbing/ukraine/area/1140720441">
                              Khortytsa
                             </a>
                             <ul>
                              <li class="">
                               <a data-nid="1144215348" href="/climbing/ukraine/area/1144215348">
                                Tourist beach
                                <span class="aka">
                                 /
                                </span>
                                Турпляж
                               </a>
                               <li class="">
                                <a data-nid="1144215402" href="/climbing/ukraine/area/1144215402">
                                 Aluminium beach
                                 <span class="aka">
                                  /
                                 </span>
                                 Алюмінієвий пляж
                                </a>
                                <li class="">
                                 <a data-nid="1144218183" href="/climbing/ukraine/area/1144218183">
                                  Dam/ГЕС
                                 </a>
                                </li>
                               </li>
                              </li>
                             </ul>
                             <li class="">
                              <a data-nid="1197895581" href="/climbing/ukraine/area/1197895581">
                               Zuevka
                              </a>
                              <li class="">
                               <a data-nid="1140777510" href="/climbing/ukraine/area/1140777510">
                                Cerkivna
                               </a>
                               <li class="">
                                <a data-nid="1296312480" href="/climbing/ukraine/area/1296312480">
                                 Onokivtsi
                                </a>
                                <li class="">
                                 <a data-nid="1296312528" href="/climbing/ukraine/area/1296312528">
                                  Smerekovyi kamin'
                                 </a>
                                 <li class="">
                                  <a data-nid="1296378471" href="/climbing/ukraine/area/1296378471">
                                   Bilyj Kamin'/Білий камінь
                                  </a>
                                  <li class="">
                                   <a data-nid="1140809388" href="/climbing/ukraine/area/1140809388">
                                    Ivanivka
                                   </a>
                                   <li class="dropdown-submenu">
                                    <a data-nid="11885041" href="/climbing/ukraine/kiev">
                                     Kyiv
                                    </a>
                                    <li class="">
                                     <a data-nid="1798563999" href="/climbing/ukraine/area/1798563999">
                                      Sokaly
                                     </a>
                                     <li class="">
                                      <a data-nid="1798564077" href="/climbing/ukraine/area/1798564077">
                                       Protyate Kaminya
                                      </a>
                                     </li>
                                    </li>
                                   </li>
                                  </li>
                                 </li>
                                </li>
                               </li>
                              </li>
                             </li>
                            </li>
                           </li>
                          </li>
                         </li>
                        </li>
                       </li>
                      </li>
                     </li>
                    </li>
                   </li>
                  </li>
                 </li>
                </li>
               </li>
              </li>
             </li>
            </li>
           </li>
          </li>
         </li>
        </li>
       </li>
      </ul>
     </div>
    </div>
    <!-- end secondary-navigation -->
   </div>
  </div>
 </div>
 <div class="regions__read">
  <div class="regions__inner">
   <div class="overview">
    <div class="node-info only-mobile expandable">
     <h2>
      <i class="before">
      </i>
      Stats and downloads
     </h2>
     <div class="content">
      <div class="group1">
       <div class="grade-summary">
        <div class="band-group">
         <div class="band grade-band">
          <b class="gb2" style="width: 71.43%" title="5 Intermediate routes">
          </b>
          <b class="gb3" style="width: 28.58%" title="2 Experienced routes">
          </b>
         </div>
         <div class="band grade-band">
         </div>
        </div>
        <p class="center">
         <a href="/en/article/grades#s2">
          Grade / ascent band
         </a>
        </p>
       </div>
      </div>
      <div class="group2">
       <p>
        <a class="btn btn-small btn-block" href="/climbing/ukraine/area/1140720441/routes">
         <i class="icon-search">
         </i>
         Route search
        </a>
       </p>
       <p>
        <a class="btn btn-small btn-block" href="/climbing/ukraine/area/1140720441/climbers/using-stat/ascents">
         <i class="icon-trophy">
         </i>
         Leaderboard
        </a>
       </p>
       <script type="text/javascript">
        $(function(){
  $(".pdf-tracking").click(function() {
    ga('send', {
      'hitType': 'pageview',
      'page': '/climbing/ukraine/area/1140720441/download-1140720441.pdf',
      'title': "Instant PDF download for Khortytsa"
    });
  });
});
       </script>
       <p>
        <div class="btn-group btn-block inline">
         <a class="btn btn-small btn-block dropdown-toggle" data-toggle="dropdown" href="#">
          Downloads
          <i class="icon-caret-down">
          </i>
         </a>
         <ul class="dropdown-menu">
          <li>
           <a class="pdf-tracking" href="https://static.thecrag.com/pdf/1140720441.pdf">
            <img alt="" height="16" src="https://static.thecrag.com//cids/images/pdf-32-1.1.0.png" width="16"/>
            Instant PDF
            <br/>
            Generic pre-created PDF - for Khortytsa
            <br/>
            The file is 0.4 MB, created 13 days ago.
           </a>
          </li>
          <li class="divider">
          </li>
          <li class="disabled">
           <a disabled="disabled">
            <img alt="" height="16" src="https://static.thecrag.com//cids/images/pdf-32-1.1.0.png" width="16"/>
            Custom PDF
            <br/>
            Personalised up-to-date PDF - for Khortytsa
            <br/>
            You must be logged in to create a custom PDF.
           </a>
          </li>
          <li class="divider">
          </li>
          <li>
           <a href="/climbing/ukraine/area/1140720441/kml">
            Google Earth (.kml)
           </a>
           <li>
            <a href="/climbing/ukraine/area/1140720441/gpx">
             GPS exchange format (.gpx)
            </a>
           </li>
          </li>
         </ul>
        </div>
       </p>
       <p>
        <a class="btn btn-small btn-block" href="/climbing/ukraine/area/1140720441/guide" title="Warning - Guide view may take some time to load for areas with large numbers of routes">
         <img alt="" height="16" src="https://static.thecrag.com/silk/html.png" width="16"/>
         HTML Guide
        </a>
       </p>
       <p>
        <a class="btn btn-small btn-block" href="/climbing/ukraine/area/1140720441/weather">
         Weather
        </a>
       </p>
      </div>
     </div>
    </div>
   </div>
   <div class="node-info only-mobile expandable">
    <h2>
     <i class="before">
     </i>
     Map
    </h2>
    <div class="content">
     <div class="node-info--maps">
      <noscript id="staticmapfallback">
      </noscript>
      <div class="contain" style="height: 290px">
       <div class="fill zcontext js-no-tooltips js-lazy-map" id="EmbedAreaMap">
        <div class="fill not-loading" style="font-size: 50vh;
    text-align: center;
    line-height: 75vh;
    color: #aaa;">
         <i class="icon-map-marker icon-em">
         </i>
        </div>
        <div class="fill" id="map">
        </div>
       </div>
       <link crossorigin="" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" rel="stylesheet"/>
       <link href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" rel="stylesheet"/>
       <link href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" rel="stylesheet"/>
       <link href="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css" rel="stylesheet"/>
       <link href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.65.0/dist/L.Control.Locate.min.css" rel="stylesheet"/>
       <script crossorigin="" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js">
       </script>
       <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js">
       </script>
       <script charset="utf-8" src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.65.0/dist/L.Control.Locate.min.js">
       </script>
       <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js">
       </script>
       <script>
        /*
 * Options:
 *  el      - id of the map element
 *  title   - template to update the page title on move
 *  bbox    - fallback bbox viewport
 */

function theCragMap(options){

    this.params = {
        // How close clusters will be in px, smaller is more clusters
        maxClusterRadius: 20,

        // How visually wide an area is before we load it's child data
        loadFov: 100,

        // How visually wide an area is before we look into it's children for more labels.
        labelFov: 200,
    };


    var that = this;

    this.options = options;
    this.debug = !!options.debug;

    this.map = L.map(options.el, {
        zoomSnap: L.Browser.mobile ? 0 : 1,
        inertiaDeceleration: 1000,
        thecragmap: this,
        zoomControl: false,
        gestureHandling: this.options.embed,
    });

    this.styles = {
        fence: {
            base: {
                weight:      1,
                color:       '#fff',
                opacity:     .5,
                fillColor:   '#fff',
                fillOpacity: .1,
                className:   ' tcm-f-base', // Keep space
            },
            region: {
                weight:      1,
                color:       '#fff0',
                fillOpacity: 0,
                className:   ' tcm-f-region', // Keep space
            },
            here: {
                weight:      1,
                opacity:     1,
                fillOpacity: 0,
            },
            inside: {
                weight:      1,
                opacity:     1,
                fillOpacity: 0,
            },
            hover: {
                color:       '#08c',
                opacity:     1,
                fillColor:   '#def',
                fillOpacity: .2,
                weight:      2,
            },
            selected: {
                color:       '#08c',
                opacity:     1,
                fillColor:   '#def',
                fillOpacity: .2,
                weight:      2,
            },
        },
    };

    this.panes = {
        labels: this.map.createPane('labelPane'),
        locate: this.map.createPane('locatePane'),
    };
    // Default marker is 600, tooltips are 650
    this.map.getPane('labelPane' ).style.zIndex = 640;
    this.map.getPane('locatePane').style.zIndex = 650;

    this.layerGroups = {
        bbox:   L.layerGroup(),//.addTo(this.map);
        number: L.layerGroup(),//.addTo(this.map);
        probe:  L.layerGroup(),//.addTo(this.map);
        label:  L.layerGroup({pane: 'labelPane'}).addTo(this.map),
        fence:  L.layerGroup().addTo(this.map),
        pie:    L.markerClusterGroup({
            showCoverageOnHover: false,
            maxClusterRadius:    this.params.maxClusterRadius,
            singleMarkerMode:    true,
            zoomToBoundsOnClick: false,
            iconCreateFunction:  this.renderGearPieFromMarkers,
            chunkedLoading:      true,
            chunkInterval:       50,
        }).addTo(this.map),
        locate: L.layerGroup({pane: 'locatePane'}).addTo(this.map),
    };

    this.newPies = []; // Temp queue for pies so we can batch load

    // All map controls
    //
    this.controls = {};
    L.control.zoom({
        position:   'bottomright',
        zoomInTitle:  thecrag.getText('template.maps.zoomin'),
        zoomOutTitle: thecrag.getText('template.maps.zoomout'),
    }).addTo(this.map);

    this.initProviders();

    this.autoLayer = null;
    this.selectedLayer = 'auto'; // This is either auto or an explicity chosen layer

    this.controls.layers = L.control.layers({}, {}, {
        collapsed: this.options.embed ? 1 : (L.Browser.mobile ? 1 : 0),
        position:  'topleft',
    }).addTo(this.map);
    this.controls.layers.addOverlay(this.layerGroups.fence, thecrag.getTextUC('object.boundary.many'));
    this.controls.layers.addOverlay(this.layerGroups.pie,   thecrag.getTextUC('object.route.many'));
    this.controls.layers.addOverlay(this.layerGroups.label, thecrag.getTextUC('object.label.many'));

    if (this.debug) {
        this.controls.layers.addOverlay(this.layerGroups.bbox,   "nbbox");
        this.controls.layers.addOverlay(this.layerGroups.number, "number");
        this.controls.layers.addOverlay(this.layerGroups.probe,  "probe");
    }

    this.updateLayerControl();

    L.control.scale().addTo(this.map);

    if (document.fullscreenEnabled || document.webkitFullscreenEnabled) {
        this.map.addControl(new L.Control.Fullscreen({
            position:   'bottomright',
            title: {
                'false': thecrag.getText('template.maps.fullscreen'),
                'true':  thecrag.getText('template.maps.exitfullscreen')
            }
        }));
    }

    this.controls.locate = L.control.locate({
        icon:       'icon-location-arrow',
        position:   'bottomright',
        setView:    'untilPan',
        layer:      this.layerGroups.locate,
        circlePadding:      [50,50],
        cacheLocation:      true,
        returnToPrevBounds: false,
        compassStyle: {
            weight:     1,
            radius: 7,
        },
        strings: {
            title: thecrag.getText('template.maps.your-location'),
        },
        locateOptions: {
            enableHighAccuracy: true,
            maxZoom: 20,
        }
    }).addTo(this.map);
//    this.controls.locate.start();

    this.map.on('moveend', function(e) {
        this.loadMap();
        var that = this;
        window.setTimeout(function() {
            that.updateLayerControl();
        }, 20);
    }, this);

    if (this.options.embed) {
        L.Control.LinkControl = L.Control.extend({

            options: {
                position: 'topright',
                label: 'button',
                href: '#',
            },

            onAdd: function (map) {
                var container = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-editnode');
                this.link = L.DomUtil.create('a', 'leaflet-control-edit-button leaflet-bar-part', container);
                this.link.href = this.options.href;
                this.link.style.padding = "0 8px";
                this.link.style.width = "auto";
                this.link.innerHTML = this.options.label;
                return container;
            }
        });
        this.controls.edit = new L.Control.LinkControl({
            href: this.options.edit,
            label: thecrag.getText('template.maps.edit-location'),
        }).addTo(this.map);
    }



    // Set viewport
    this.initView();

    this.map.on('moveend zoomend', function(e) {
        this.options.thecragmap.updateURL();
    });
    this.map.on('baselayerchange', function (e) {
        if (!this.autoLayerSwapping) {
            this.selectedLayer = e.layer.options.id;
        }

        this.updateURL();
    }, this);

    this.layerGroups.pie.on({
        'clustermouseover': function (e) {
            var nodes = that.getNodesFromCluster(e.layer);
            $('body').trigger('node.over', {id: nodes[0].id, nodes: nodes });
        },
        'clustermouseout': function (e) {
            var nodes = that.getNodesFromCluster(e.layer);
            $('body').trigger('node.out', {id: nodes[0].id, nodes: nodes });
        },
        'clusterclick': function (e) {
            var nodes = that.getNodesFromCluster(e.layer);
            $('body').trigger('node.focus', {id: nodes[0].id, nodes: nodes });
        },
    });


	$('body').bind('node.over', function(e,data){
        that.nodeOver(data.id, data.nodes);
    });
	$('body').bind('node.out', function(e,data){
        that.nodeOut(data.id, data.nodes);
    });
	$('body').bind('node.focus', function(e,data){
        var node = that.index[data.id];
        var nodes = data.nodes || [node]
        that.popupForNodes(nodes);
    });
	$('body').bind('node.select', function(e,data){
        var node = that.index[data.id];
        if (!node) return;
        that.nodeSelect(data.id);
    });
	$('body').bind('node.deselect', function(e,data){
        var node = that.index[data.id];
        if (!node) return;
        that.nodeDeselect(data.id);
    });

}


theCragMap.prototype = {


    tree:   {}, // In memory data store

    index:  {}, // nid index to nodes in the tree

    // Layer in-memory store:
    store: {
        bbox:   {},   // debug
        number: {},   // debug
        probes: null, // debug
        pie:    {},
        fence:  {},
        labels: {},
    },

    node2url: function(node) {
        var url = node.stub ? ('/climbing/'+node.stub) : ('/'+node.id);
        return url;
    },

    /*
     * Given either 'auto' or a string like 'satellite.sixmaps'
     */
    selectBaseLayer: function(name) {
        //
        var parts    = name.split('.');
        var type     = parts[0];
        var provider = parts[1];

        if(this.layers[provider] && this.layers[provider][type]) {
            this.layers[provider][type].layer.addTo(this.map);
            this.selectedLayer = type + '.'+provider;
        } else {
            this.autoLayer.layer.addTo(this.map);
            this.selectedLayer = 'auto';
        }
    },


    /*
     * Given a node update the crumb trail
     * TODO should actually replace the top nav menu too via common.js
     */
    updateCrumbFrom: function (node) {

        if (this.options.embed) return;

        var crumbs = [];
        var last = node;
        while(node) {
            crumbs.unshift({
                nid:   node.id,
                href:  this.node2url(node),
                label: node.name,
            });
            node = node.up;
        }
        crumbs[0].label = null;
        crumbs[0].icon = 'globe';
        crumbs.push({
            href:  this.node2url(last) + '/maps' + location.hash,
            label: this.options.title,
        });

        // TODO fix loading race condition (move to prod ready js file will do this for free)
        if (thecrag.crumbs) {
            thecrag.crumbs.replace(crumbs);
        }
    },

    /**
     * Show a popup for a node, analagous to a crag card
     */
    popupForNodes: function(nodes) {
        var node = nodes[0];
        var $html = $('<div>');

        var url = this.node2url(node);
        var $heading = $('<h4>');
        var name = node.name;
        if (node.g) {
            $('<span class="label label-info">Gym</span>').appendTo($heading);
        }
        $('<b>').text(name).appendTo($heading);
        $heading.appendTo($html);

        var $info = $('<div>');

        var $crumbs = $('<div class="crumbtrail-partial">');
        for(var me=node.up,c=0; me,c<2; me=me.up,c++) {
            var $crumb = $('<span class="crumbtrail-partial__crumb">');
            $('<span><i class="icon-angle-right"></i>').appendTo($crumb);
            $('<a>').attr({href:this.node2url(me)}).text(me.name).appendTo($crumb);
            $crumb.prependTo($crumbs);
        }
        $crumbs.find('.crumbtrail-partial__crumb:first span').remove();
        $crumbs.appendTo($info);

        if (node.numberRoutes > 0) {
            $('<div class="pull-right pad4">').append(renderStyleDonut(node.gearStyles,getClusterRadius(node.numberRoutes))).appendTo($info);
        }

        $stats = $('<div class="pull-left">');
        if (!node.rt) {
            $('<p><a class="iblock" href="'+url+'/routes' +'">'+(node.numberRoutes ||0)+'  routes</a></p>').appendTo($stats);
        }
        $('<p><a class="iblock" href="'+url+'/ascents'+'">'+(node.numberAscents||0)+' ascents</a></p>').appendTo($stats);
        if (node.children && node.children.length && node.res.numberRoutes > 0) {
            $('<p><span class="label label-warn">'+(node.res.numberRoutes ||0)+' unlocated routes</span></p>').appendTo($stats);
        }
        $stats.appendTo($info);

        if (node.rt) {
            $('<p class="clearfix"><a class="btn iblock" href="'+url+'">Open route</a></p>').appendTo($info);
        } else {
            $('<p class="clearfix"><a class="btn iblock" href="'+url+'">Open guide</a></p>').appendTo($info);
        }
        $info.appendTo($html);

        // Other neaby nodes
        //html.+ ' + ' +(nodes.length-1) + ' more';

        var popup = L.popup({'className' : 'tcm-popup'})
            .setLatLng(this.index[node.id].rcenter)
            .setContent($html[0].outerHTML);
        if (this.controls.locate.stopFollowing) {
            this.controls.locate.stopFollowing();
        }
        this.map.openPopup(popup);
    },


    bubbleSize: function(routes) {
        return Math.round(10 + Math.log(routes+1)*3);
    },

    renderGearPieFromMarkers: function(cluster) {
        var markers = cluster.getAllChildMarkers();
        var routes = 0;
        var styles = {};
        for (var i=0; i<markers.length; i++) {
            var m = markers[i];
            routes += m.options.node.res.numberRoutes;
            var gear = m.options.node.res.gearStyles;
            for (var s in gear) {
                if (!styles[s]) {
                    styles[s] = 0;
                }
                styles[s] += gear[s];
            }
        }


        var bubblesize = thecrag.map.bubbleSize(routes);

        var html = '<div></div>';

        // TODO loading race condition
        if (window.getClusterRadius) {
            // bubblesize = getClusterRadius(routes);
            html = renderStyleDonut(styles, bubblesize);
        }

        return L.divIcon({
            className: 'tcmap--gear-pie',
            iconSize: bubblesize,
//            html: '<div style="'+styles+'">' + routes + '</div>'
            html: html
        });
    },


    /*
     * Given a cluster, find the best nodes to represent it
     *
     * This is guaranteed to return at least 1 node, but maybe multiple
     */
    getNodesFromCluster: function(cluster) {

        var level = 1;

        var totalvotes = 0;
        var quorum = {};
        var lastQuorum = {};
        var nodes = [];
        var weight = [];

        var markers = cluster.getAllChildMarkers();
        for (var i=0; i<markers.length; i++) {
            var node = markers[i].options.node;
            nodes.push(node);
            level = Math.max(level,node.level);
            totalvotes += node.res.numberRoutes;
            weight.push(node.res.numberRoutes);
        }

        // This winning node must account for an large majority
        // of the routes in the cluster
        var winvotes = Math.floor(totalvotes * 0.75);

        // Ok so now each marker gets a vote weighted by its route count
        // If there is a majority vote for a node then it wins.
        // If not then each vote is delegated to it's parent but with the
        // same weight as before.
        for (var lev = level; lev > 0; lev--) {
            lastQuorum = quorum;
            quorum = {};
            var levTotal = 0;

            for (var n=0; n<nodes.length; n++) {
                var node = nodes[n];
                while(node.level > lev) {
                    node = node.up;
                    nodes[n] = node;
                }
                var nid = node.id;
                if (quorum[nid]) {
                    quorum[nid] += weight[n];
                } else {
                    quorum[nid] = weight[n];
                }
                levTotal += weight[n];
                if (quorum[nid] > winvotes) {

                    // Ok we have a winner but is it too vague?
                    if (quorum[nid] < node.numberRoutes * .75 && Object.keys(lastQuorum).length > 0) {
                        // So we now have a winner but we've clearly gone too far up
                        // so go back a step and return a list of nodes.
                        nodes = [];
                        for(var k in lastQuorum) {
                            nodes.push(this.index[k]);
                        }
                        nodes.sort(function(a,b) {
                            return b.numberRoutes - a.numberRoutes;
                        });
                        return nodes;
                    } else {
                        return [node];
                    }
                }
            }
            if (levTotal == 0) {
                return nodes;
            }
        }

        // We should never get here
        throw('Error no best node was found');
    },

    /*
     * Parses the hash, sets the viewport, and sets base layer
     */
    setViewFromHash: function() {
        if (location.hash.match(/^(.*),(.*),(.*)$/)){
            var load = location.hash.substring(1).split(/,/);
            var lat     = parseFloat(load[0]);
            var lng     = parseFloat(load[1]);
            var zoom    = parseFloat(load[2]);
            load[3] = parseFloat(load[3]); // TODO hint
            var base    = load[4] || '';

            this.selectBaseLayer(base);
            this.map.setView([lat,lng], zoom);
            return true;
        }
        return false;
    },


    /*
     * This sets up the inital viewport
     */
    initView: function() {

        this.map.setMaxZoom(20);

        if (this.setViewFromHash() ) {
            // Nothing more to do
            //
        } else if (this.options.bbox) {
            // If node path but no hash
            this.map.fitBounds(this.options.bbox, {
                paddingTopLeft: [10,10],
                paddingBottomRight: [10,10],
            });

            this.autoLayer.layer.addTo(this.map);
        } else {


            this.autoLayer.layer.addTo(this.map);

            // If no node or lat long then show a world map
            this.map.fitBounds([
                [ 60, -160], // Alaska
                [-50,  180]  // New zealand bottom right
            ]);
        }
    },

    /*
     * Updates the url for roundtrip bookmarking and reloading
     */
    updateURL: function(){

        if (this.options.embed) return;

        var center = this.map.getCenter();
        var lat = center.lat;
        var lng = center.lng;
        var zoom = this.map.getZoom();
        var hint = '';
        var type = this.selectedLayer;
        var fixed = Math.floor((zoom+1) / 3);
        var hash = lat.toFixed(fixed)+','
                  +lng.toFixed(fixed)+','
                  +zoom.toFixed(1)+','+hint+','+type;
        var url = '';
        if (this.here) {
            url = this.node2url(this.here);
        }
        url += '/maps';

        if (history.replaceState){
            history.replaceState({},'', url + '#' + hash);
        } else {
            location.hash = hash;
        }

        var title = this.options.title +': ';
        if (this.here) {
            title += this.here.name;
        }
        title += ' | theCrag';
	    document.title = title;
        // TODO update all top level nav links, should be in common.js

    },

    /*
     * This loads all the layers into memory
     */
    initProviders: function() {

        this.layers = {
            mapbox: {
                terrain: {
                    name: "Terrain",
                    type: 'terrain',
                    priority: 1,
                    layer: L.tileLayer('https://api.tiles.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}{r}.png?access_token={token}', {
                        id: 'terrain.mapbox',
                        attribution:
                            '© <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'
                            +', '+
                            'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>'
                            ,
                        maxNativeZoom:  18,
                        maxZoom:        20,
                        token: 'pk.eyJ1IjoiYnJlbmRhbmhleXdvb2QiLCJhIjoiY2psN2pqNmxmMHAzdzNrcW95YzdrNmNubCJ9.Rze2qNQxFdcomZxusVdVhw',
                    }),
                },
            },

            arcgis: {
                satellite: {
                    name: "Satellite",
                    type: 'satellite',
                    priority: 1,
                    layer:  L.tileLayer('https://server.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                        id: 'satellite.arcgis',
                        attribution: '© ARCGIS',
                        maxNativeZoom:  18,
                        maxZoom:        20,
                    }),
                    // Overlay for labels
                },
            },

            sixmaps: {
                satellite: {
                    name: "SixMaps",
                    type: 'satellite',
                    priority: 2,
                    bounds: [[-27, 155],
                             [-38, 138]],
                    nid: 11738059,
                    layer: L.tileLayer('https://maps.six.nsw.gov.au/arcgis/rest/services/public/NSW_Imagery/MapServer/tile/{z}/{y}/{x}', {
                        id: 'satellite.sixmaps',
                        attribution: '© Land and Property Information, NSW',
                        maxNativeZoom:  18,
                        maxZoom:        20,
                    }),
                },
            },

            /*
            // Coordinate system is totally different
            vicmap: {
                satellite: L.tileLayer('https://base.maps.vic.gov.au/service?SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&LAYER=AERIAL_VG&STYLE=default&FORMAT=image/png&TILEMATRIXSET=EPSG:3111&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}', {
                    id: 'vicmap.imagery',
                    attribution: '© VicMap',
                    maxNativeZoom:  18,
                    maxZoom:        20,
                }),
            },
            */
            tasmap: {
                satellite: {
                    name: "TasMap",
                    type: 'satellite',
                    priority: 2,
                    nid: 11738203,
                    bounds: [[-39, 154],
                             [-45, 140]],
                    layer: L.tileLayer('https://services.thelist.tas.gov.au/arcgis/rest/services/Basemaps/Orthophoto/ImageServer/tile/{z}/{y}/{x}', {
                        id: 'satellite.tasmap',
                        attribution: '© TasMap',
                        maxNativeZoom:  19,
                        maxZoom:        20,
                    }),
                },
            },

            samap: {
                satellite: {
                    name: "Location SA",
                    type: 'satellite',
                    priority: 2,
                    nid: 11738155,
                    bounds: [[-25, 143],
                             [-39, 126]],
                    layer: L.tileLayer('https://location.sa.gov.au/mapproxy/wmts/PublicMosaic/webmercator_22/{z}/{x}/{y}.png', {
                        id: 'satellite.samap',
                        attribution: '© Location SA',
                        maxNativeZoom:  20,
                        maxZoom:        20,
                    }),
                },
            },

            osm: {
                street: {
                    name: "OSM",
                    type: 'street',
                    priority: 0, // Never choose this on auto
                    layer: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        id: 'street.osm',
                        maxNativeZoom:  19,
                        maxZoom:        20,
                        attribution: '© <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                    }),
                },
            },
        };

    },

    updateLayerControl: function() {

        // Now that we have all the layers we need to decide which ones are valid
        // for the current viewport.

        var baseLayers = {};

        // We may not even have a viewport yet, if so just assume we are ok and
        // we will check again later
        var zoom = this.map.getZoom();
        var hasView = zoom !== undefined;

        lp: for(var p in this.layers) {
            var prov = this.layers[p];
            ll: for(var l in prov) {
                var layer = prov[l];

                if (!hasView ||
                    !layer.bounds ||
                    // bounds - this filter can be done easily based on the viewport and
                    // before we may have loaded any api data so it can fail faster.
                    L.latLngBounds(layer.bounds).contains(this.map.getBounds()) ) {

                    // Also check node filtering, but ignore this if we don't yet have node data
                    // This is imperfect, if we are *near* the nod we will load it, and then
                    // exclude it, but if we are far away we won't load it and it will stay.
                    if (!layer.nid || !this.store.fence[layer.nid]) {
                        baseLayers[layer.name] = layer;
                    } else {
                        // Should we also filter to nodes? This needs to be a little soft
                        // as we want to allow maps which are on the edge.

                        var nid = layer.nid;
                        var me = this.here;
                        while(me) {
                            if (me.id == nid) {
                                baseLayers[layer.name] = layer;
                                continue ll;
                            }
                            me = me.up;
                        }

                    }
                }
            }
        }

        // nid - this filter is more exact but can only be done after data has
        // loaded, which will be after a zoom, eg zoom into NSW to load sixmaps

        // Now that we know which layers are valid, which layer is preferred if
        // we are into auto mode?

        // First, use street at high zoom and satellite at deep zoom
        var type = (zoom && zoom > 12) ? 'satellite' : 'terrain';

        var autoLayer = null;
        for(var l in baseLayers) {
            var lay = baseLayers[l];
            var priority = lay.priority || 0;
            if (lay.type == type &&
                (!autoLayer || priority > autoLayer.priority)) {
                autoLayer = lay;
            }
        }

        // maxNativezoom - if another layer has a higher max native zoom than
        // the current map of the same type then swap to it.

        // After have have done the filtering we also set the prioirty of the layers


        var control = this.controls.layers;

        for (var l in this.baseLayers) {
            var lay = this.baseLayers[l];
            control.removeLayer(lay.layer);
        }
        for (var l in baseLayers) {
            var lay = baseLayers[l];
            control.addBaseLayer(lay.layer, l);
        }
        this.baseLayers = baseLayers;

        // Lastly if we are in auto mode then select the auto layer
        if (this.selectedLayer == 'auto') {
            if (this.autoLayer != autoLayer) {
                this.autoLayerSwapping = true;
                if (this.autoLayer) {
                    this.map.removeLayer(this.autoLayer.layer);
                }
                this.map.addLayer(autoLayer.layer);
                var that = this;
                window.setTimeout(function() {
                    that.autoLayerSwapping = false;
                }, 20);
            }
        }

        this.autoLayer = autoLayer;
    },


    /*
     * Given a bbox and FoV find the best nodes to label in the viewport
     *
     * 1) Logic is to find nodes which are bigger than the FoV and within view
     * 2) then find their children
     * 3) then rank all of candidates by depth and then by # of ascents
     * 4) then add to the map one by one and make sure we don't overlap an existing
     *    labels
     *
     *
     */
    findLabels: function findLabels(bounds, fov, node, level) {

        var that = this;

        if (!node.bbox) {
            return [];
        }

        if (bounds.getEast()  < node.bbox[0] ||
            bounds.getNorth() < node.bbox[1] ||
            bounds.getWest()  > node.bbox[2] ||
            bounds.getSouth() > node.bbox[3]) {
            return [];
        }

        var me = {
            depth:    level,
            name:     node.name,

            priority: (node.numberAscents || 0) + (node.numberRoutes || 0),
            fov:      node.fov,
            node:     node,
        };
        if (node.g) {
            me.priority *= .1;
            if (node.g == 2) {
                me.priority += 100;
            }
        }

        // If we got here, but we are too small then return current node
        // But if we happen to be a region, and we happen to have children
        // then drill down more
        if (node.fov <= fov) {
            return [me];
        }


        // If we are big enough, then look into our kids
        var labels = [];
        if (node.children) {
            $.each(node.children, function(i,v) {
                labels = labels.concat(that.findLabels(bounds, fov, v, level + 1));
            });
        }

        // If we have children, then let them take over our priority:
        me.priority = node.res.numberAscents + node.res.numberRoutes;

        // Only add me if I don't have children, or I have a residue
        if (labels.length == 0 || me.priority > 0) {
            if (!node.r) {
                // Never show labels for regions
                labels.push(me);
            }
        }
        return labels;
    },

    hasClash: function(zoom, x, y) {
        var hash = x+'-'+y;

        var clash = this.clashes[hash];
        if (0) { // debug
            var bounds = [
                this.map.unproject([x+1,y+1], zoom),
                this.map.unproject([x  ,y  ], zoom)
            ];
            L.rectangle(bounds, {color: !clash?"#005500" : "#ff7800", weight: 1}).addTo(this.map);
        }
        return clash;
    },
    setClash: function(x, y) {
        var hash = x+'-'+y;
        this.clashes[hash] = 1;
    },
    /*
     * Given some positions try to reserve them
     * If taken return true
     *
     * zoom     - how granular should the clashes be?
     * latlong  - center of the shape we are trying to reserve
     * offsets  - a collection of pixel offsets to draw of rough shape
     *            of what we are rendering. Depends on the zoom size
     */
    detectClash: function detectClash(zoom, latlng, offsets) {

        var pixel = this.map.project(latlng, zoom);
        var px = Math.floor(pixel.x);
        var py = Math.floor(pixel.y);

        var clash = 0;

        for(var c=0; c<offsets.length;c++) {
            var o = offsets[c];
            var x = px+Math.floor(o[0]);
            var y = py+Math.floor(o[1]);
            clash = clash || this.hasClash(zoom,x  ,y  );
            clash = clash || this.hasClash(zoom,x+1,y  );
            clash = clash || this.hasClash(zoom,x  ,y+1);
            clash = clash || this.hasClash(zoom,x+1,y+1);
        }

        if (clash) {
            return true;
        }
        for(var c=0; c<offsets.length;c++) {
            var o = offsets[c];
            var x = px+Math.floor(o[0]);
            var y = py+Math.floor(o[1]);
            this.setClash(x  ,y  );
            this.setClash(x+1,y  );
            this.setClash(x  ,y+1);
            this.setClash(x+1,y+1);
        }
        return false;
    },
    detectClashReset: function detectClashReset() {
            this.clashes = {};
    },

    // Super simple collision detection
    clashes: {},


    /*
     * This creates a label for a single node and adds it to the map
     *
     */
    createLabel: function(node, labelOverride) {

        var label = L.marker(node.rcenter, {
            nodeid: node.id,
            node: node,
            pane: 'labelPane',
        })
        label.on({
            'mouseover': function(e){
                var node = e.target.options.node;
                $('body').trigger('node.over', {id: node.id });
            },
            'mouseout': function(e){
                var node = e.target.options.node;
                $('body').trigger('node.out', {id: node.id });
            },
            'click': function(e){
                var node = e.target.options.node;
                $('body').trigger('node.focus', {id: node.id });
            },
        });
        this.store.labels[node.id] = label;

        label.addTo(this.layerGroups.label);

        var bubblesize = Math.floor(this.bubbleSize(node.res.numberRoutes)/2)+1;

        var $label = $(
            '<div class="tcm-anchor">'
                +'<div class="tcm-label__name"></div>'
            +'</div>'
        );
        var name = labelOverride || node.name;
        $label.find('.tcm-label__name').text(name);

        var anchorOffset = bubblesize + 15;
        $label.css("transform", "translate("+(node.dx*anchorOffset)+"px, "+(node.dy*anchorOffset)+"px)");
        if (node.g) {
            $label.find('.tcm-label__name').prepend('<span class="label label-info">Gym</span>');
        }

        var $arrow = $('<div class="tcm-label-arrow"></div>')
            .css("transform", "rotate("+node.aspectDeg+"deg) translate(0, -"+(bubblesize+2)+"px)");

        var icon = L.divIcon({
            className: 'tcm--node-label ' + node.aspectClasses,
            iconSize: null,
            html: $label[0].outerHTML + $arrow[0].outerHTML,
            iconAnchor: [0,0], // dx * bubblesize, dy * bubblesize],
        });
        label.setIcon(icon);
        return label;
    },


    /*
     *
     *
     */
    updateLabels: function updateLabels() {

        var map = this.map;
        var store = this.store;
        var viewport = map.getBounds();

        var zoom = map.getZoom();

        var fov = this.params.labelFov / (2**zoom);

        if (0) { // debug fov
            var bounds = [
                [map.center.lat,     map.center.lng    ],
                [map.center.lat+fov, map.center.lng+fov],
            ];

            L.rectangle(bounds, {color: "blue", weight: 1}).addTo(map);
        }

        var labels = this.findLabels(viewport, fov, this.tree, 1);

        labels.sort(function(a,b) {
            return b.priority - a.priority;
        });

        // Filter to only labels in our viewport
        labels = labels.filter(function(label) {
            return viewport.contains(label.node.rcenter);
        });

        var shown = 0;
        this.detectClashReset();

        var now = (+ new Date());

        // It's weird seeing labels for really important stuff next to
        // empty things, so this sets a contrast based cap. There is
        // often a couple big outriders at the top, so start at num 5
        var minPriority = 0;
        if (labels.length > 5) {
            minPriority = Math.floor(labels[4].priority * 0.1)-1;
        }

        for(var c=0; c<labels.length; c++) {

            var l = labels[c];
            var node = l.node;

            var dx = node.dx;
            var dy = node.dy;

            var charoff = 0; // For classes on ends of labels

            // Detect clashes, but only if not max zoom
            if (zoom < 20) {
                var margin = zoom - 4; //TODO Tune, 4 smaller = more markers, larger = 6 less collisions
                var reserve = [];

                var chars = node.name.length;
                if (node.g) {
                    chars += 5;
                }

                // Reserve the arrow line
                reserve.push([0  ,0  ]);
                reserve.push([dx  ,dy  ]);
                reserve.push([dx*2,dy*2]);
                reserve.push([dx*2-1,dy*2]);
                reserve.push([dx*2+1,dy*2]);

                // Reserve the label space
                if (dx  > 0) { charoff =  1; }
                if (dx  < 0) { charoff = -1; }
                reserve.push([dx*2+(charoff+0)*chars*0.10,dy*2]);
                reserve.push([dx*2+(charoff-1)*chars*0.06,dy*2]);
                reserve.push([dx*2+(charoff+1)*chars*0.06,dy*2]);
                reserve.push([dx*2+(charoff-1)*chars*0.12,dy*2]);
                reserve.push([dx*2+(charoff+1)*chars*0.12,dy*2]);

                var clash = this.detectClash(margin, node.rcenter, reserve);
                if(clash) {
                    continue;
                }

                if (shown++ > 40) break; // No matter what, we don't need too many labels
                if (l.priority < minPriority) continue; // Don't show really low labels next to big ones
            }

            var label = store.labels[node.id];
            if (!label) {
                label = this.createLabel(node);
            }
            label.options.lastmod = now;
        }

        // Now remove old labels
        for(var nid in store.labels){
            var lab = store.labels[nid];
            if (lab.options.lastmod < now) {
                lab.removeFrom(this.layerGroups.label);
                delete store.labels[nid];
            }
        }

    },

    /*
     * Given a node ojbect inside the store
     * recalculate the 'residual' stats. ie after
     * a child has been added with say X routes then
     * the parents route count marker should be reduced
     * by X.
     *
     * Works depth first, recursing back out to the trunk
     */
    recalcAncestors: function recalcAncestors(node, up) {

        if (!node) {
            node = theCragMap.tree;
        }
        this.index[node.id] = node;

        if (!node.aspect) {
            node.aspect = [];
        }

        // Calculate all the things that cascade down
        node.up = up;
        if (node.up) {
            node.level = node.up.level+1;
            node.aspectAll = _.uniq(node.aspect.concat(node.up.aspect));

            // Top level region concept, everything above TLC
            if (!node.tlr) {
                // We are a top level region only if we are a region
                // and all of our ancestors also are
                node.tlr = node.r && node.up.tlr;
            }

        } else {
            node.level = 1;
            node.aspectAll = node.aspect;
            node.tlr = 1;
        }

        if (!node.aspectClasses) {
            // First which way are we pointing? Combine all the tags
            var dx = 0;
            var dy = 0;

            if (node.aspectAll) {
                for (var c2=0; c2<node.aspectAll.length; c2++) {
                    var aspect = node.aspectAll[c2];
                    switch (aspect) {
                        case 'N' : dx +=  0; dy +=  1; break;
                        case 'NE': dx -= .7; dy += .7; break;
                        case 'E' : dx -=  1; dy +=  0; break;
                        case 'SE': dx -= .7; dy -= .7; break;
                        case 'S' : dx +=  0; dy -=  1; break;
                        case 'SW': dx += .7; dy -= .7; break;
                        case 'W' : dx +=  1; dy -=  0; break;
                        case 'NW': dx += .7; dy += .7; break;
                    }
                }
            }

            // Default to north
            if (dx == 0 && dy == 0) {
                dy = 1;
            }


            node.aspectRad = Math.atan2(-dx, dy);

            // aspectRad = Math.random() * Math.PI * 2; // debug of random angles

            node.aspectDeg = Math.floor(node.aspectRad / Math.PI * 180 + 360) % 360;

            var dx = node.dx =  Math.sin(node.aspectRad).toFixed(2);
            var dy = node.dy = -Math.cos(node.aspectRad).toFixed(2);

            var classes= '';
            if (dx  > 0) { classes += ' al'; }
            if (dx == 0) { classes += ' ac'; }
            if (dx  < 0) { classes += ' ar'; }
            if (dy  > 0) { classes += ' vt'; }
            if (dy == 0) { classes += ' vm'; }
            if (dy  < 0) { classes += ' vb'; }

            node.aspectClasses = classes;
        }



        if (node.children) {
            var that = this;
            $.each(node.children, function(i,v) {
                that.recalcAncestors(v, node);
            });
        }

        if (node.bbox) {
            if (!node.fov) {
                node.fov = Math.max(
                    node.bbox[3] - node.bbox[1],
                    node.bbox[2] - node.bbox[0]
                );
            }
            if (!node.center) {
                node.center = [
                    (node.bbox[1] + node.bbox[3])/2,
                    (node.bbox[0] + node.bbox[2])/2
                ];
            }
            if (node.center && !node.rcenter) {
                node.rcenter = [
                    node.center[1],
                    node.center[0],
                ];
            }

        }

        // Calculate all the things that cascade up

        // TODO efficiency: detect that the residue is unchanged and exit early

        // Now that our children are calculated work back up the ancestors
        node.res = node.res || {};

        // TODO numberRoutes cannot be trusted, so ignore it: Culprit it unknown / aid / traverse stats
        node.res.numberRoutes  = node.numberRoutes   || 0;
        node.res.numberAscents = node.numberAscents  || 0;
        node.res.gearStyles    = $.extend({}, node.gearStyles); // Must be object clone
        // residualGrade from grade

        node.gearStyles = node.gearStyles || {};
        var unknown = 0
        for (var s in node.gearStyles) {
            if (s == 'unknown') continue;
            unknown += node.gearStyles[s];
        }
        node.gearStyles['unknown'] = node.numberRoutes - unknown;

        // Now subtract stats for children which are located
        if (node.children) {
            $.each(node.children, function(i,child) {
                if (child.bbox) {
                    node.res.numberRoutes  -= child.numberRoutes  || 0;
                    node.res.numberAscents -= child.numberAscents || 0;
                    for (var s in child.gearStyles) {
                        node.res.gearStyles[s] = node.res.gearStyles[s] || 0;
                        node.res.gearStyles[s] -= child.gearStyles[s];
                    }
                }
            });
        }

        // Api doesn't return unknown so calc that now
        // TODO this is still totally fucked
        var known = 0
        for (var s in node.res.gearStyles) {
            if (s == 'unknown') continue;
            known += node.res.gearStyles[s];
        }
        node.res.gearStyles['unknown'] = node.res.numberRoutes - known;


    },

    /*
     * This shows the 5 probes points used to determine what node best
     * represents where the viewport is.
     */
    updateProbeMarkers: function updateProbeMarkers() {
        // These are the 5 'probes' for getting a quorum of where we are based on map viewport
        //
        var map = this.map;
        var that = this;
        var viewport = map.getPixelBounds();
        var center = map.getCenter();
        if (!this.probes) {
            this.probes = [];
            for(var i=0; i<5; i++) {
                this.probes[i] = {
                    ancestors: []
                }
                if (this.debug) {
                    this.probes[i].marker = L.marker(center).bindPopup('probe').addTo(this.layerGroups.probe);
                }
            }
        }

        var p = this.probes;
        var spread = .4;
        var spreadX = (viewport.max.x - viewport.min.x) /2 * spread;
        var spreadY = (viewport.max.y - viewport.min.y) /2 * spread;
        var centerP = map.project(center);

        this.probe(0, map.project(center), 'center');
        this.probe(1,[centerP.x - spreadX, centerP.y ], 'West');
        this.probe(2,[centerP.x + spreadX, centerP.y ], 'East');
        this.probe(3,[centerP.x, centerP.y - spreadY ], 'North');
        this.probe(4,[centerP.x, centerP.y + spreadY ], 'South');

        // Now find a quorum of points to find out whhich node best
        // represents where we are.
        var pos = 0;
        var votes = {};
        var nodes = {};
        var quorum = false;
        var here;
        do {
            votes = {};
            nodes = {};
            quorum = false;
            for(var c=0; c<5; c++) {
                var n = p[c].ancestors[pos];
                if (n) {
                    nodes[n.id] = n;
                    if (votes[n.id]){
                        votes[n.id]++;
                    } else {
                        votes[n.id]=1;
                    }
                }
            }
            for(var vote in votes){
                if (votes[vote] > 2) {
                    here = nodes[vote];
                    pos++;
                    quorum = true;
                }
            }

        } while(quorum);

        var oldhere = this.here;

        if (here != oldhere) {

            this.here = here;

            var fence;
            if (oldhere) {
                fence = this.store.fence[oldhere.id];
                var node = oldhere;
                while (node) {
                    node.inside = 0;
                    node = node.up
                }
                this.updateNodeStyles(oldhere);
            }
            if (here) {
                var node = this.here;
                while (node) {
                    node.inside = 1;
                    this.updateNodeStyles(node);
                    node = node.up
                }

                this.updateURL();
                window.setTimeout(function() {
                    // Do this async so we don't block label render
                    that.updateCrumbFrom(here);
                }, 20);
            }
        }

    },


    /*
     * Probe a point to see where we are
     *
     */
    probe: function probe(index, xy, label) {

        var latlng = this.map.unproject(xy);
        var p = this.probes[index];

        var node = this.findDeepestNode(latlng);
        if (this.debug) {
            p.marker.setLatLng(latlng);
            p.marker._popup.setContent(node ? node.name : 'none').addTo(this.layerGroups.probe);
        }

        // Find our ancestor chain
        p.ancestors = [];
        var me = node;
        while(me) {
            p.ancestors.unshift(me);
            me = me.up;
        }
    },

    /*
     * given a lat long, recurse down the tree and find the closest
     * and smallest sized node which contains this lat lng.
     *
     * At any step this could match multiple nodes so check all
     * children to find the smallest and closest.
     */
    findDeepestNode: function findDeepestNode(latlng, node) {

        var that = this;

        if (!node) {
            node = this.tree;
        }

        if (!node.bbox) {
            return;
        }

        // Is the latlng outside this node? if so then return null
        if (latlng.lng < node.bbox[0] ||
            latlng.lat < node.bbox[1] ||
            latlng.lng > node.bbox[2] ||
            latlng.lat > node.bbox[3]) {
            return;
        }

        // If inside then recurse to children

        if (node.children) {
            var matches = [];

            // Find all children who contain our point
            $.each(node.children, function(i,n) {
                var p = node;
                var m = that.findDeepestNode(latlng,n);
                if (m) matches.push(m);
            });

            // If only one child then easy
            if (matches.length == 1) {
                return matches[0];
            }

            // If more than one then first see if only some of them are
            // actually inside the fence rather than just the bbox
            var inside = matches.filter(function isInside(node) {
                var fence = that.store.fence[node.id];
                if (!fence) return false;
                return that.isLatLngInsidePolyon(latlng, fence);
            });
            if (inside.length > 0 && inside.length < matches.length) {
                matches = inside;
            }
            if (matches.length == 1) {
                return matches[0];
            }

            // If still more than one candidate try closest / smallest
            if (matches.length > 0) {

                matches.sort(function(a,b) {
                    return a.numberRoutes - b.numberRoutes;
                });

                return matches[0];
            }
        }

        // If no child then return ourselves
        return node;
    },

    isLatLngInsidePolyon: function isLatLngInsidePolygon(latlng, poly) {
        var polyPoints = poly.getLatLngs()[0]; // Assumes no donuts
        var x = latlng.lat, y = latlng.lng;

        var inside = false;
        for (var i = 0, j = polyPoints.length - 1; i < polyPoints.length; j = i++) {
            var xi = polyPoints[i].lat, yi = polyPoints[i].lng;
            var xj = polyPoints[j].lat, yj = polyPoints[j].lng;

            var intersect = ((yi > y) != (yj > y))
                && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
            if (intersect) inside = !inside;
        }

        return inside;
    },

    nodeOver: function(nid, nodes) {
        var node = this.index[nid];
        if (!node) return;
        var styles = this.styles;

        var fence = this.store.fence[nid];
        if (fence) {
            if (!node.tlr && !node.inside) {
                fence.setStyle(styles.fence.hover);
            }
        }

        var label = this.store.labels[nid];
        // Business rules for showing a hover label are complex:
        if (!label &&                                   //
            (!node.tlr ||                               // Show if TLC or below
             (node.tlr && node.res.numberRoutes>0)      // Or we are a region and still have residual routes (rare)
            )
            && (!this.here || node.id != this.here.id)  // But never if we are here, because 'here' is never interactive
        ) {
            // We have hovered a small cluster with no label so first lets add a temporary label
            // possibly with multiple labels
            var names = undefined;
            if (nodes && nodes.length > 1) {
                if (nodes.length > 2) {
                    names = nodes[0].name + ',\n'
                          + nodes[1].name + ' & more';
                } else {
                    names = nodes[0].name + ' &\n'
                          + nodes[1].name;
                }
            }
            label = this.createLabel(node, names);

            label.temp = 1;
        }
        if (label) {
            label._icon.classList.add('tcm--node-label--hover');
            label.setZIndexOffset(50);
        }

    },
    nodeOut: function(nid) {
        var node = this.index[nid];
        if (!node) return;

        var label = this.store.labels[nid];
        if (label && label.temp) {
            label.removeFrom(this.layerGroups.label);
            delete this.store.labels[nid];
            label = null;
        }
        if (label) {
            label._icon.classList.remove('tcm--node-label--hover');
            label.setZIndexOffset(0);
        }
        if (node) {
            this.updateNodeStyles(node);
        }
    },

    nodeSelect: function(nid) {
        var node = this.index[nid];
        if (!node) return;
        this.options.selected = nid;
        this.updateNodeStyles(node);
    },

    nodeDeselect: function(nid) {
        var node = this.index[nid];
        if (!node) return;
        if (this.options.selected == nid) {
            this.options.selected = '';
        }
        this.updateNodeStyles(node);
    },

    /*
     * Redraw the fence and labels using the latest styles that apply
     */
    updateNodeStyles: function(node) {

        var fence = this.store.fence[node.id];

        if (fence) {
            var styles = this.getFenceStyles(node);
            fence.setStyle(styles);

            // className hack due to leaflet bug https://github.com/Leaflet/Leaflet/issues/2662
            fence._path.classList.remove('tcm-f-here');
            fence._path.classList.remove('tcm-f-inside');
            var classes = styles.className.trim().split(/\s/);
            for(var c=0; c<classes.length;c++) {
                fence._path.classList.add(classes[c]);
            }
        }

        var label = this.store.labels[node.id];
        if (label) {

        }

    },

    getFenceStyles: function(node) {
        var styles = this.styles.fence;
        var fstyle = node.r ? styles.region : styles.base;
        fstyle = $.extend(true, {}, fstyle);
        if (this.here) {
            if (node.inside == 1) {
                fstyle.className += ' tcm-f-inside';
                $.extend(fstyle, styles.inside);
            }
            if(this.here.id  == node.id) {
                fstyle.className += ' tcm-f-here';
                $.extend(fstyle, styles.here);
            }
        }
        if (node.id == this.options.selected) {
            fstyle.className += ' tcm-f-selected';
            $.extend(fstyle, styles.selected);
        }

        return fstyle;
    },

    /*
     * After a node has changed, update the various markers
     * to reflect these changes.
     *
     * This is the only place that should create or update markers
     * It should work purely from data in the store
     */
    updateNodeMarkers: function updateNodeMarkers(node) {
        // Debug BBOX for each node
        var id = node.id;
        var bbox = node.bbox;

        var layers = this.layerGroups;
        var store = this.store;

        if (!bbox) return;


        var center = node.rcenter;

        if (this.debug) {

            var polygon = store.bbox[id];
            if (!polygon) {
                var latlngs = [
                    [bbox[1], bbox[0]],
                    [bbox[3], bbox[0]],
                    [bbox[3], bbox[2]],
                    [bbox[1], bbox[2]],
                ];
                var err = 0;
                var ratio = (bbox[3]-bbox[1])/(bbox[2]-bbox[0]);
                if (ratio > 20 || ratio  < .05) {
                    err = 1;
                    console.log('error '+node.level+' -> '+node.up.name+' > '+node.name+', '+node.id);
                }
                polygon = L.polygon(latlngs, {
                    weight: 1,
                    fillOpacity: .05,
                }).addTo(layers.bbox);
                store.bbox[id] = polygon;
                polygon.options.node = node;
                polygon.on({
                    'click': function(e){
                        var node = e.target.options.node;
                        window.prompt('NID', node.name +', '+node.id);
                    },
                });
            }
            polygon.setStyle({
                    color: err ? 'purple' : (node.children ? 'green' : 'red'),
            });

            // Debug count for each node
            var numLabel = store.number[id];
            if (!numLabel) {
                numLabel = L.marker(center, {}).addTo(layers.number);
                store.number[id] = numLabel;
            }
            var icon = L.divIcon({
                html: '<div>'+node.id +'</div> - '+node.numberRoutes + '/'+node.res.numberRoutes,
            });
            numLabel.setIcon(icon);
        }

        if (node.geometry) {
            // The actualy fence polygon on the map is used by 'here'
            var shown = !node.r;
            var fence = store.fence[id];
            if (!fence) {
                var latlngs = JSON.parse(node.geometry);
                $.each(latlngs, function(i,n) {
                    latlngs[i] = [latlngs[i][1], latlngs[i][0]];
                });
                fence = L.polygon(latlngs, this.getFenceStyles(node)).addTo(layers.fence);
                fence.options.node = node;
                store.fence[id] = fence;
                fence.on({
                    'mouseover': function(e){
                        var node = e.target.options.node;
                        $('body').trigger('node.over', {id: node.id });
                    },
                    'mouseout': function(e){
                        var node = e.target.options.node;
                        $('body').trigger('node.out', {id: node.id });
                    },
                    'click': function(e){
                        var node = e.target.options.node;
                        // If we are inside this fence, then ignore clicks
                        if (!node.inside && !node.r) {
                            $('body').trigger('node.focus', {id: node.id });
                        }
                    },
                });
            }
        }


        // The real pie chart end deal
        var pie = store.pie[id];

        // If we are a lead node always show a marker, even a 0 one
        // but if we were a parent, and then our children loaded and
        // now we are empty, remove ourselves.
        var show = node.res.numberRoutes > 0 || !node.children;

        if (show) {
            if (!pie) {
                pie = L.marker(center, {
                    node: node,
                })
                store.pie[id] = pie;
                pie.on({
                    'mouseover': function (e) {
                        var node = e.target.options.node;
                        $('body').trigger('node.over', {id: node.id });
                    },
                    'mouseout': function (e) {
                        var node = e.target.options.node;
                        $('body').trigger('node.out', {id: node.id });
                    },
                    'click': function (e) {
                        var node = e.target.options.node;
                        $('body').trigger('node.focus', {id: node.id });
                    },

                });
            }
            this.newPies.push(pie);

            if (this.debug) {
                var icon = L.divIcon({
                    html: '<div>'+node.res.numberRoutes+'</div>',
                });
                numLabel.setIcon(icon);
            }
        } else {
            if (pie) {
                pie.removeFrom(layers.pie);
            }
        }


        if (node.children) {
            var that = this;
            $.each(node.children, function(i,n) {
                that.updateNodeMarkers(n);
            });
        }

    },


    /**
     * Given a new sub tree of data it will
     * 1) graft this onto the in memory cache
     * 2) create bbox debugging polygons
     * 3) create node bubbles
     */
    graftSubtree: function graftSubtree(data, tree) {

        var bbox = data.bbox;

        $.extend(true, this.tree, data);

        this.refreshAll();

    },

    refreshAll: function() {

        this.recalcAncestors(this.tree);

        this.updateNodeMarkers(this.tree);
        this.layerGroups.pie.addLayers(this.newPies);
        this.newPies = [];

        this.updateProbeMarkers(); // Sets here which is used by label next
        this.updateLabels();

        this.updateLayerControl();

        // TODO this is brute force, try and only refresh ones which have changed
        // We only need to update markers whose residue has gone down.
        this.layerGroups.pie.refreshClusters();
    },

    /*
     * This looks for all nodes which we are aware of, but which do
     * not have children data so we can make a delta data sync
     *
     * nodes    - passed in object with map from id to store object
     * bounds   - viewport
     * fov      - nodes larger than this will be laoded
     * node     - recursive node position in tree
     */
    getDeltaNodes: function(nodes, bounds, fov, node) {

        var that = this;

        if (!node.bbox) {
            return;
        }

        if (bounds.getEast()  < node.bbox[0] ||
            bounds.getNorth() < node.bbox[1] ||
            bounds.getWest()  > node.bbox[2] ||
            bounds.getSouth() > node.bbox[3]) {
            return;
        }

        // If we got here, but we are too small then stop
        if (node.fov <= fov) {
            return;
        }


        // If we are big enough and we have children then recurse
        if (node.children) {
            $.each(node.children, function(i,v) {
                that.getDeltaNodes(nodes, bounds, fov, v);
            });
        } else {
            // If childen is empty then add this to the list
            nodes[node.id] = node;
        }

    },

    mergeDelta: function(delta) {

        var that = this;
        var stored = this.index[delta.id];
        if (delta.children) {
            if (stored.children) {
                $.each(delta.children, function(i,child) {
                    that.mergeDelta(child);
                });
            } else {
                stored.children = delta.children;
            }
        }
    },

    /*
     * Whereever we are right now, load info for this viewport
     * and graft it into the tree cache, then refresh markers
     */
    loadMap: function() {

        var that = this;

        // We do this both before and after, before because we may
        // have changed viewport and we can updated immediately and
        // then potentially a second time after loadng more data
        this.updateProbeMarkers(); // Sets here which is used by label next
        this.updateLabels();

        var zoom = this.map.getZoom();
        var fixed = Math.floor((zoom+1) / 3);
        var bbox = this.map.getBounds();
        var s = bbox.getNorthWest().lng.toFixed(fixed)+','+
                bbox.getSouthEast().lat.toFixed(fixed)+','+
                bbox.getSouthEast().lng.toFixed(fixed)+','+
                bbox.getNorthWest().lat.toFixed(fixed);
        var fov = this.params.loadFov / (2**zoom); 
        var that = this;

        // Have we loaded anything yet?
        if (this.tree.id) {
            var nodes = {};
            this.getDeltaNodes(nodes, bbox, fov, this.tree);
            var nids = Object.keys(nodes).join(',');
            if (nids) {
                $.getJSON('/api/map/bbox/heirachy?s='+s+'&f=geometry,gearStyles,numberRoutes,numberAscents&v='+fov+'&o='+nids,
                    function(data) {
                        var c1 = nodes;
                        var c2 = nids;
                        that.mergeDelta(data.data.visible[0]);
                        // TODO is this safe?
                        for(var nid in nodes) {
                            var store = that.index[nid];
                            if (!store.children) {
                                console.warn('Missing children');
                                store.children = [];
                            }
                        }
                        that.refreshAll();
                    }
                );
            }
        } else {

            $.getJSON('/api/map/bbox/heirachy?s='+s+'&f=geometry,gearStyles,numberRoutes,numberAscents&v='+fov,
                function(data) {
                    that.graftSubtree(data.data.visible[0]);
                }
            );
        }
    }
};



this.thecrag = this.thecrag || {};
function initMapEmbedAreaMap() {
    thecrag.map = new theCragMap({
        el: 'map',
        embed: 1,
        edit: "/climbing/ukraine/area/1140720441/locate",
        bbox: [    [47.849338,35.0514726],    [47.7951663,35.1431398]],
        selected: 1140720441,
    });
}
       </script>
       <script>
        function initMapTopo(){

	// If the container has some height, then force it open
	var $ni = $('#EmbedAreaMap').closest('.node-info');

	if ($ni.find('.content').height() == 0){
		$ni.one( "sectionopen", function() {
			initMapTopo();
		});
		return;
	}
	$ni.removeClass('expandable');

    initMapEmbedAreaMap();
}
$(initMapTopo);
       </script>
      </div>
      <p class="center pad4">
       <a class="btn btn-small" href="https://www.google.com/maps/dir/?api=1&amp;destination=47.822188,35.095485" target="_blank">
        <img height="20" src="https://static.thecrag.com/cids/images/gmaps-app-1.1.1.png" width="20"/>
        Directions in Google Maps
       </a>
      </p>
     </div>
    </div>
   </div>
   <div class="clearfix">
   </div>
   <div class="node-info">
    <h2>
     <i class="before">
     </i>
     Tags
    </h2>
    <div class="content">
     <a class="tags" href="/en/article/tagging#Beginners" rel="tag">
      Beginners
     </a>
     <a class="tags" href="/en/article/tagging#Granite" rel="tag">
      Granite
     </a>
     <a class="icontag" href="/en/article/tagging#Kid friendly" rel="tag">
      <img height="36" src="https://static.thecrag.com/cids/images/tag-kid-friendly-1.1.0.svg" width="36">
       Kid friendly
      </img>
     </a>
     <a class="icontag" href="/en/article/tagging#Dog friendly" rel="tag">
      <img height="36" src="https://static.thecrag.com/cids/images/tag-dog-friendly-1.1.0.svg" width="36"/>
      Dog friendly
     </a>
     <a class="icontag" href="/en/article/tagging#Camping" rel="tag">
      <img height="36" src="https://static.thecrag.com/cids/images/tag-camping-1.1.0.svg" width="36"/>
      Camping
     </a>
     <a class="icontag" href="/en/article/tagging#Fire" rel="tag">
      <img height="36" src="https://static.thecrag.com/cids/images/tag-fire-1.1.0.svg" width="36"/>
      Fire
     </a>
    </div>
   </div>
   <script type="text/javascript">
    var defaultSelect = '1140720441';
   </script>
   <div class="clearfix">
   </div>
   <form action="/CIDS/cgi-bin/cids.cgi" class="donttrackunsaved" method="post">
    <div class="node-listview hide-archived">
     <h2 class="inline">
      Areas
     </h2>
     <span class="btn-group-group">
      <small class="btn-group inline">
       <a class="btn btn-mini disabled">
        <i class="icon-plus-sign icon-create">
        </i>
        Add area(s)
       </a>
      </small>
      <small class="btn-group inline">
       <a class="btn btn-mini disabled">
        <i class="icon-plus-sign icon-create">
        </i>
        Add topo
       </a>
      </small>
      <small class="btn-group inline">
       <a class="btn btn-mini disabled">
        <i class="icon-plus-sign icon-create">
        </i>
        Reorder
       </a>
       <a class="btn btn-mini disabled">
        <i class="icon-list-ol">
        </i>
        Bulk edit
       </a>
      </small>
     </span>
     <div class="area header">
      <div class="loc">
       <i class="icon-map-marker" title="Has location data">
       </i>
      </div>
      <div class="name">
       Name
      </div>
      <div class="style">
       Style
      </div>
      <div class="stats">
       <div class="routes">
        Routes
       </div>
       <div class="ticks">
        Ticks
       </div>
       <div class="height">
        Height
       </div>
       <div class="grades">
        Grades
       </div>
       <div class="topos">
        <i class="icon-picture" title="Number of phototopos">
        </i>
       </div>
       <div class="a-pop" title="Popularity">
        <i class="icon-bar-chart">
        </i>
       </div>
      </div>
     </div>
     <div class="area" data-nid="1144215348">
      <div class="loc">
       <a class="mappin missing" href="/climbing/ukraine/area/1144215348/locate" title="Missing location">
        1
       </a>
      </div>
      <div class="name">
       <a href="/climbing/ukraine/area/1144215348">
        Tourist beach
        <span class="aka">
         /
        </span>
        Турпляж
       </a>
       <span class="type">
        Sector
       </span>
      </div>
      <div class="style">
       <a href="/routes/at/1144215348/with-gear-style/sport/" title="Filter to 2 Sport climbing routes">
        <b class="bullet sport">
        </b>
        All Sport climbing
       </a>
      </div>
      <div class="stats">
       <div class="routes">
        2
       </div>
       <div class="ticks">
        0
       </div>
       <div class="height">
       </div>
       <div class="grades">
        <div class="band grade-band">
         <b class="gb2" style="width: 100%" title="2 Intermediate routes">
         </b>
        </div>
       </div>
       <div class="topos">
        1
       </div>
       <div class="a-pop">
        <a class="iblock pop pop--0" href="/climbing/ukraine/area/1144215348/ascents" title="Relative popularity (0) - No  ascents">
         <span class="va-m">
         </span>
        </a>
       </div>
      </div>
     </div>
     <div class="area" data-nid="1144215402">
      <div class="loc">
       <a class="mappin missing" href="/climbing/ukraine/area/1144215402/locate" title="Missing location">
        2
       </a>
      </div>
      <div class="name">
       <a href="/climbing/ukraine/area/1144215402">
        Aluminium beach
        <span class="aka">
         /
        </span>
        Алюмінієвий пляж
       </a>
       <span class="type">
        Sector
       </span>
      </div>
      <div class="style">
       -
      </div>
      <div class="stats">
       <div class="routes">
        0
       </div>
       <div class="ticks">
        0
       </div>
       <div class="height">
       </div>
       <div class="grades">
        <div class="band grade-band">
        </div>
       </div>
       <div class="topos">
       </div>
       <div class="a-pop">
        <a class="iblock pop pop--0" href="/climbing/ukraine/area/1144215402/ascents" title="Relative popularity (0) - No  ascents">
         <span class="va-m">
         </span>
        </a>
       </div>
      </div>
     </div>
     <div class="area" data-nid="1144218183">
      <div class="loc">
       <a class="mappin missing" href="/climbing/ukraine/area/1144218183/locate" title="Missing location">
        3
       </a>
      </div>
      <div class="name">
       <a href="/climbing/ukraine/area/1144218183">
        Dam/ГЕС
       </a>
       <span class="type">
        Sector
       </span>
      </div>
      <div class="style">
       <a href="/routes/at/1144218183/with-gear-style/sport/" title="Filter to 7 Sport climbing routes">
        <b class="bullet sport">
        </b>
        All Sport climbing
       </a>
      </div>
      <div class="stats">
       <div class="routes">
        7
       </div>
       <div class="ticks">
        0
       </div>
       <div class="height">
       </div>
       <div class="grades">
        <div class="band grade-band">
         <b class="gb2" style="width: 60%" title="3 Intermediate routes">
         </b>
         <b class="gb3" style="width: 40%" title="2 Experienced routes">
         </b>
        </div>
       </div>
       <div class="topos">
        1
       </div>
       <div class="a-pop">
        <a class="iblock pop pop--0" href="/climbing/ukraine/area/1144218183/ascents" title="Relative popularity (0) - No  ascents">
         <span class="va-m">
         </span>
        </a>
       </div>
      </div>
     </div>
    </div>
   </form>
  </div>
 </div>
 <div class="regions__prominent">
  <div class="regions__inner">
   <style>
    .alert.alert-new {
	background-color: #3a3;
	color: white;
	text-shadow: none;
	font-size: 14px;
	border: 4px solid #262;
	padding: 13px;
	border-radius: 8px;
}
.alert.alert-new a {
	color: white;
	text-decoration: underline;
}
   </style>
   <div class="alert alert-new">
    <h2 style="color:white;border:none;font-size:2em;">
     Did you know?
    </h2>
    <p>
     Did you know that you can create an account to record, track and share your climbing ascents? Thousands of climbers are already doing this.
    </p>
   </div>
  </div>
 </div>
 <div class="regions__aside">
  <div class="regions__inner">
   <div class="box">
    <h4 class="heading hash-target h4 mart0">
     <span class="offset">
      <a id="contributors">
      </a>
     </span>
     <a class="heading__t" href="#contributors">
      Top editors by karma
     </a>
    </h4>
    <div class="contributors">
     <a class="climber va-t aiblock" href="/climber/dimayevtushenko" title="Dima Yevtushenko - Sport climber, Ukraine - Crag Karma: 665">
      <div class="face iblock face--3" style="font-size:48px;">
       <div class="face__b fill">
        <div class="face__c">
         <div class="face__load">
          <i class="icon-user icon-em">
          </i>
         </div>
         <img alt="" src="/avatar/949932573"/>
        </div>
       </div>
      </div>
     </a>
    </div>
    <p>
     <a class="iblock" href="/climbing/ukraine/area/1140720441/contributors">
      See all contributors
     </a>
     |
     <a href="/en/article/cragkarma">
      <i class="icon-info-sign icon-em">
      </i>
      Karma
     </a>
    </p>
   </div>
   <div class="box sponsors">
    <h4 class="heading hash-target h4 clearfix">
     <span class="offset">
      <a id="sponsors">
      </a>
     </span>
     <a class="heading__t" href="#sponsors">
      Sponsors
     </a>
    </h4>
    <div class="sponsor-item">
     <div class="fixedimg" style="padding-bottom: 70.435%">
      <a class="fill" href="https://awesome-maps.com/en/worldmaps/climbing-map?ref=5bc659da2a931" target="_blank" title="Awesome Maps - Sponsor of World">
       <span alt="Awesome Maps - Sponsor of World" class="js-lazy-sponsor fill" data-action="Awesome Maps" data-label="World &gt; Awesome Maps (1524269304 )" data-src="https://image.thecrag.com/230x162/6a/f9/6af9dbfce393dafad71ea27b1d9f8116af67a1c4" title="Awesome Maps - Sponsor of World">
       </span>
      </a>
     </div>
    </div>
    <div class="sponsor-item">
     <div class="fixedimg" style="padding-bottom: 70.435%">
      <a class="fill" href="https://awesomewoodys.com/" target="_blank" title="Awesome Woodys - Sponsor of World">
       <span alt="Awesome Woodys - Sponsor of World" class="js-lazy-sponsor fill" data-action="Awesome Woodys" data-label="World &gt; Awesome Woodys (923340867 Other)" data-src="https://image.thecrag.com/230x162/50/6c/506c4bb5a02b11c42eb1ad383b3b5cca5bd765b1" title="Awesome Woodys - Sponsor of World">
       </span>
      </a>
     </div>
    </div>
   </div>
   <script>
    $(function(){
    $('.js-lazy-sponsor').lazy({
        effect: "fadeIn",
        effectTime: 1000,
        threshold: 0,
        afterLoad: function(element) {
            ga('send', 'event', {
                'eventCategory': 'Sponsor',
                'eventAction': element.context.dataset.action,
                'eventLabel': element.context.dataset.label,
                'nonInteraction': 1
            });
        }
    });
});
   </script>
   <div class="box">
    <h4 class="heading hash-target h4 clearfix">
     <span class="offset">
      <a id="photos">
      </a>
     </span>
     <a class="heading__t" href="#photos">
      Photos
     </a>
     <span class="heading__more pull-right">
      <a href="/climbing/ukraine/area/1140720441/photos">
       Browse all photos
       <i class="icon-angle-right">
       </i>
      </a>
     </span>
    </h4>
    <p class="center">
     <a class="btn btn-small" href="/processmap/uploadphoto/1140720441">
      <i class="icon-cloud-upload">
      </i>
      Upload a photo of area
     </a>
    </p>
    <div class="photo-list">
     <div class="link-photo round4 contain" style="display: inline-block; width: 240px">
      <div style="padding-top:133.333%">
      </div>
      <div class="fill placeholder-icon">
       <i class="icon-em icon-picture">
       </i>
      </div>
      <div class="fill">
       <a class="fill photo" href="/photo/1144233072">
        <img class="js-lazy-img" data-src="https://image.thecrag.com/240x320/78/a1/78a14d0babdaaec10a39a9745c31cfe0ea1f145a" height="320" itemprop="photo" width="240"/>
       </a>
       <p class="title">
        <a href="/climbing/ukraine/area/1144215348" title="World › Europe › Ukraine › Khortytsa ">
         Tourist beach
        </a>
        - campus.jpg
       </p>
      </div>
     </div>
     <div class="link-photo round4 contain" style="display: inline-block; width: 240px">
      <div style="padding-top:75.000%">
      </div>
      <div class="fill placeholder-icon">
       <i class="icon-em icon-picture">
       </i>
      </div>
      <div class="fill">
       <a class="fill photo" href="/photo/1144233078">
        <img class="js-lazy-img" data-src="https://image.thecrag.com/240x180/08/67/08672c0350219e148bf4f764d3794338464afbbc" height="180" itemprop="photo" width="240"/>
       </a>
       <p class="title">
        <a href="/climbing/ukraine/area/1144215348" title="World › Europe › Ukraine › Khortytsa ">
         Tourist beach
        </a>
        - Хортиця кемп.jpg
       </p>
      </div>
     </div>
     <div class="link-photo round4 contain" style="display: inline-block; width: 240px">
      <div style="padding-top:66.667%">
      </div>
      <div class="fill placeholder-icon">
       <i class="icon-em icon-picture">
       </i>
      </div>
      <div class="fill">
       <a class="fill photo" href="/photo/1144235376">
        <img class="js-lazy-img" data-src="https://image.thecrag.com/240x160/28/e2/28e2067101ad006748cccfa62f09d1a596ff0ec2" height="160" itemprop="photo" width="240"/>
       </a>
       <p class="title">
        <a href="/climbing/ukraine/area/1140720441" title="World › Europe › Ukraine ">
         Khortytsa
        </a>
        - Хортиця.png
       </p>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
 <div class="regions__stream">
  <div class="clearfix">
  </div>
  <div class="regions__inner">
   <h3 class="heading hash-target h3 clearfix">
    <span class="offset">
     <a id="stream">
     </a>
    </span>
    <a class="heading__t" href="#stream">
     Activity
    </a>
   </h3>
   <p>
    Check out what is happening in Khortytsa.
   </p>
   <div class="stream-group-settings">
    <input checked="checked" data-object-type="ticks" id="id-ticks" name="show-ticks" type="checkbox"/>
    <label for="id-ticks">
     ticks
    </label>
    <input checked="checked" data-object-type="updates" id="id-updates" name="show-updates" type="checkbox"/>
    <label for="id-updates">
     updates
    </label>
    <input checked="checked" data-object-type="discussions" id="id-discussions" name="show-discussions" type="checkbox"/>
    <label for="id-discussions">
     discussions
    </label>
   </div>
   <div class="stream">
    <div class="stream-content">
    </div>
    <button class="btn btn-large btn-block replace-initialise stream-button" data-date="2019-02-01" data-original-url="https://www.thecrag.com/climbing/ukraine/area/1140720441/stream?showGroup=ticks,discussions,updates" data-replace-container=".stream" data-replace-content=".stream-content" data-replace-function="stream-function" data-replace-mode="append" data-replace-prepare="stream-prepare" data-replace-resolve="stream" data-replace-url="https://www.thecrag.com/climbing/ukraine/area/1140720441/stream?showGroup=ticks,discussions,updates">
     <i class="icon-refresh">
     </i>
     Load more
    </button>
   </div>
  </div>
 </div>
 <div class="clearfix">
 </div>
</div>
<a href="/climbing/ukraine/area/1167711555" rel="prev">
 <span>
  Sector V
 </span>
</a>
<a href="/climbing/ukraine/area/1144215348" rel="next">
 <span>
  Tourist beach
 </span>
</a>
<footer class="bg-brand-blue" id="footer" role="contentinfo">
 <div class="inner">
  <h1 class="hide">
   General information
  </h1>
  <div class="links">
   <h4>
    Privacy
   </h4>
   <ul>
    <li>
     <a href="/copyright">
      Copyright
     </a>
     <li>
      <a href="/terms">
       Site usage policy
      </a>
      <li>
       <a href="/privacy">
        Privacy policy
       </a>
       <li>
        <a href="/en/article/behavior">
         Acceptable behavior
        </a>
       </li>
      </li>
     </li>
    </li>
   </ul>
  </div>
  <div class="links">
   <h4>
    About theCrag
   </h4>
   <ul>
    <li>
     <a href="/en/article/contactus">
      Contact us
     </a>
     <li>
      <a href="/en/article/vision">
       Our mission and vision
      </a>
      <li>
       <a href="/en/article/media">
        Media resources
       </a>
      </li>
     </li>
    </li>
   </ul>
  </div>
  <div class="links">
   <h4>
    Contribute
   </h4>
   <ul>
    <li>
     <a href="/en/article/contributing">
      Adding content
     </a>
     <li>
      <a href="/en/article/supporter">
       Donations
      </a>
      <li>
       <a href="/en/article/sponsor">
        Sponsorship
       </a>
       <li>
        <a href="/en/article/issues">
         Feature requests
        </a>
       </li>
      </li>
     </li>
    </li>
   </ul>
  </div>
  <div class="links" itemscope="" itemtype="http://schema.org/Organization">
   <h4>
    Follow theCrag
   </h4>
   <link href="https://www.thecrag.com" itemprop="url"/>
   <link href="https://static.thecrag.com/cids/images/logo17-1.1.1.svg" itemprop="logo"/>
   <ul>
    <li>
     <a href="https://www.facebook.com/thecragcom" itemprop="sameas" target="_blank">
      <i class="icon-facebook-sign">
      </i>
      Facebook
     </a>
     <li>
      <a href="https://www.instagram.com/thecrag_worldwide/" itemprop="sameas" target="_blank">
       <i class="icon-instagram">
       </i>
       Instagram
      </a>
      <li>
       <a href="https://www.linkedin.com/company/2041579" itemprop="sameas" target="_blank">
        <i class="icon-linkedin-sign">
        </i>
        LinkedIn
       </a>
       <li>
        <a href="https://www.youtube.com/user/supportatthecrag" itemprop="sameas" target="_blank">
         <i class="icon-youtube-play">
         </i>
         YouTube
        </a>
        <li>
         <a href="/qr?target=wechat">
          <i class="icon-comments">
          </i>
          WeChat
         </a>
        </li>
       </li>
      </li>
     </li>
    </li>
   </ul>
  </div>
 </div>
</footer>
<!-- close footer -->
<div id="tip">
</div>
<script>
 tc_translate = {
   keys: {
    'js.common.hide': 'hide',
    'js.common.hide.label': 'Hide {label}',
    'js.common.show-more': 'Show more',
    'js.process.edit-to-preview': 'Edit to preview',
    'object.boundary.many': 'boundaries',
    'object.label.many': 'labels',
    'object.route.many': 'routes',
    'process.button.log-ascent': 'Log ascent(s)',
    'process.button.log-ascent.many': 'Log {count} ascents',
    'process.button.log-ascent.one': 'Log ascent',
    'process.button.save': 'Save',
    'template.account.profile.edit-this-ascent': 'Edit this ascent',
    'template.map.autoswap': 'Auto swap maps',
    'template.maps.edit-location': 'Edit location',
    'template.maps.exitfullscreen': 'Exit fullscreen',
    'template.maps.fullscreen': 'View fullscreen',
    'template.maps.your-location': 'Your location',
    'template.maps.zoomin': 'Zoom in',
    'template.maps.zoomout': 'Zoom out',
    'template.message.add-your-comment': 'Add your comment',
    'template.message.button.edit-comment': 'Edit comment',
    'template.message.you-replied-just-then': 'You replied just then.',
    'template.stream.button-forum-discussion': 'Forum discussion',
    'template.stream.comment-on-this-ascent': 'Comment on this ascent',
    'template.stream.comment-on-this-event': 'Comment on this event',
    'template.stream.end-of-stream': 'End of stream (note the system currently does not go back past 2010).',
    'template.stream.full-stream-event': 'Full stream event',
    'template.stream.full-stream-event-comments': 'Full stream event comments',
    'template.stream.log-ascent-of-this-route': 'Log ascent of this route',
    'template.stream.moderate-discussion': 'Moderate discussion',
    'template.stream.no-events-between': 'No events between {startDate} and {endDate} - click Load more to go back further.',
    'template.stream.source-stream-event': 'Source stream event',
    'template.stream.stream-settings': 'Stream settings',
    'template.stream.this-is-a-private-event': 'This is a private event for {name}. People they link to can see it.',
    'template.stream.this-is-a-public-event': 'This is a public event.',
    'template.stream.this-is-your-private-event': 'This is your private event. You and people you link to can see it.',
    'template.stream.view-all-ascents-of-this-route': 'View all ascents of this route',
    'template.stream.view-this-ascent': 'View this ascent',
    'template.stream.view-this-route': 'View this route',
    'template.stream.why-you-see-this': 'Why you see this'
   }
 };
</script>
<script src="https://static.thecrag.com/cids/tc_translate-min-1.1.1.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/jquery/poshytip-1.1/jquery.poshytip.local.min.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/bootstrap/2.1.1-c7/js/bootstrap.min.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/common-min-1.1.43.js" type="text/javascript">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.6/jquery.lazy.min.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/process-min-1.2.22.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/message-min-1.1.17.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/autocomplete-min-1.1.1.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/ichord/jquery.caret.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/ichord/jquery.atwho.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/select2-v3.5/select2.min.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/completions-min-1.1.17.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/inlineattachment/jquery.inline-attachment.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/area-listview-min-1.1.14.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/phototopo-min-1.1.12.js" type="text/javascript">
</script>
<script src="https://static.thecrag.com/cids/stream-min-1.1.7.js" type="text/javascript">
</script>
<!-- close wrapper -->
